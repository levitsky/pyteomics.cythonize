<!DOCTYPE html>
<!-- Generated by Cython 0.22 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p>Generated by Cython 0.22</p>
<p>Raw output: <a href="cparser.c">cparser.c</a></p>
<div class="cython"><pre class='cython line score-0'>&#xA0;001: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class='cython line score-0'>&#xA0;002: <span class="k">from</span> <span class="nn">cpython.ref</span> <span class="k">cimport</span> <span class="n">PyObject</span><span class="p">,</span> <span class="n">Py_INCREF</span></pre>
<pre class='cython line score-0'>&#xA0;003: <span class="k">from</span> <span class="nn">cpython.dict</span> <span class="k">cimport</span> <span class="n">PyDict_GetItem</span><span class="p">,</span> <span class="n">PyDict_Next</span><span class="p">,</span> <span class="n">PyDict_SetItem</span></pre>
<pre class='cython line score-0'>&#xA0;004: <span class="k">from</span> <span class="nn">cpython.int</span> <span class="k">cimport</span> <span class="n">PyInt_AsLong</span><span class="p">,</span> <span class="n">PyInt_Check</span><span class="p">,</span> <span class="n">PyInt_FromLong</span></pre>
<pre class='cython line score-0'>&#xA0;005: <span class="k">from</span> <span class="nn">cpython.float</span> <span class="k">cimport</span> <span class="n">PyFloat_AsDouble</span></pre>
<pre class='cython line score-0'>&#xA0;006: <span class="k">from</span> <span class="nn">cpython.list</span> <span class="k">cimport</span> <span class="p">(</span><span class="n">PyList_GET_ITEM</span><span class="p">,</span> <span class="n">PyList_GetItem</span><span class="p">,</span> <span class="n">PyList_SetItem</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;007:                            <span class="n">PyList_SET_ITEM</span><span class="p">,</span> <span class="n">PyList_Append</span><span class="p">,</span> <span class="n">PyList_Insert</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;008:                            <span class="n">PyList_Size</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;009: <span class="k">from</span> <span class="nn">cpython.tuple</span> <span class="k">cimport</span> <span class="n">PyTuple_GetItem</span><span class="p">,</span> <span class="n">PyTuple_GET_ITEM</span></pre>
<pre class='cython line score-0'>&#xA0;010: <span class="k">from</span> <span class="nn">cpython.sequence</span> <span class="k">cimport</span> <span class="n">PySequence_GetItem</span></pre>
<pre class='cython line score-0'>&#xA0;011: <span class="k">from</span> <span class="nn">cpython.exc</span> <span class="k">cimport</span> <span class="n">PyErr_Occurred</span></pre>
<pre class='cython line score-0'>&#xA0;012: <span class="k">from</span> <span class="nn">cpython.object</span> <span class="k">cimport</span> <span class="n">PyObject_CallMethodObjArgs</span><span class="p">,</span> <span class="n">PyObject_Not</span><span class="p">,</span> <span class="n">PyObject_IsTrue</span></pre>
<pre class='cython line score-0'>&#xA0;013: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+014: <span class="k">import</span> <span class="nn">re</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_re, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_re, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+015: <span class="k">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">deque</span></pre>
<pre class='cython code score-19'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_deque);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_deque);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_deque);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_collections, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_deque);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_deque, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+016: <span class="k">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span></pre>
<pre class='cython code score-8'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_itertools, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_it, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-39' onclick='toggleDiv(this)'>+017: <span class="k">from</span> <span class="nn">pyteomics.auxiliary</span> <span class="k">import</span> <span class="n">PyteomicsError</span><span class="p">,</span> <span class="n">memoize</span><span class="p">,</span> <span class="n">BasicComposition</span></pre>
<pre class='cython code score-39'>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_PyteomicsError);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_PyteomicsError);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_PyteomicsError);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_memoize);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_memoize);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_memoize);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_BasicComposition);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_n_s_BasicComposition);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_BasicComposition);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pyteomics_auxiliary, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_PyteomicsError);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_PyteomicsError, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_memoize);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_memoize, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_BasicComposition);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_BasicComposition, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;018: </pre>
<pre class='cython line score-0'>&#xA0;019: <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;020:     <span class="nb">list</span> <span class="n">std_amino_acids</span><span class="p">,</span> <span class="n">std_labels</span></pre>
<pre class='cython line score-0'>&#xA0;021:     <span class="nb">str</span> <span class="n">std_nterm</span><span class="p">,</span> <span class="n">std_cterm</span></pre>
<pre class='cython line score-0'>&#xA0;022:     <span class="nb">object</span> <span class="n">_modX_sequence</span><span class="p">,</span> <span class="n">_modX_group</span><span class="p">,</span> <span class="n">_modX_split</span></pre>
<pre class='cython line score-0'>&#xA0;023: </pre>
<pre class='cython line score-0'>&#xA0;024: </pre>
<pre class='cython line score-46' onclick='toggleDiv(this)'>+025: <span class="n">std_amino_acids</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Q&#39;</span><span class="p">,</span><span class="s">&#39;W&#39;</span><span class="p">,</span><span class="s">&#39;E&#39;</span><span class="p">,</span><span class="s">&#39;R&#39;</span><span class="p">,</span><span class="s">&#39;T&#39;</span><span class="p">,</span><span class="s">&#39;Y&#39;</span><span class="p">,</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="s">&#39;P&#39;</span><span class="p">,</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;S&#39;</span><span class="p">,</span></pre>
<pre class='cython code score-46'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(20);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Q);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_Q);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Q);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_W);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_W);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_W);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_E);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_n_s_E);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_E);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_R);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_n_s_R);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_R);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_T);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, __pyx_n_s_T);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_T);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Y);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, __pyx_n_s_Y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_I);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 6, __pyx_n_s_I);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_I);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_P);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 7, __pyx_n_s_P);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_P);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_A);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 8, __pyx_n_s_A);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_A);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_S);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 9, __pyx_n_s_S);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_S);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_D);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 10, __pyx_n_s_D);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_D);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_F);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 11, __pyx_n_s_F);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_F);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_G);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 12, __pyx_n_s_G);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_G);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_H);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 13, __pyx_n_s_H);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_H);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_K);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 14, __pyx_n_s_K);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_K);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_L);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 15, __pyx_n_s_L);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_L);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_C);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 16, __pyx_n_s_C);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_C);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_V);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 17, __pyx_n_s_V);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_V);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_N);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 18, __pyx_n_s_N);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_N);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_M);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 19, __pyx_n_s_M);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_M);
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_v_9pyteomics_7cparser_std_amino_acids);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_9pyteomics_7cparser_std_amino_acids, ((PyObject*)__pyx_t_1));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;026:                    <span class="s">&#39;D&#39;</span><span class="p">,</span><span class="s">&#39;F&#39;</span><span class="p">,</span><span class="s">&#39;G&#39;</span><span class="p">,</span><span class="s">&#39;H&#39;</span><span class="p">,</span><span class="s">&#39;K&#39;</span><span class="p">,</span><span class="s">&#39;L&#39;</span><span class="p">,</span><span class="s">&#39;C&#39;</span><span class="p">,</span><span class="s">&#39;V&#39;</span><span class="p">,</span><span class="s">&#39;N&#39;</span><span class="p">,</span><span class="s">&#39;M&#39;</span><span class="p">]</span></pre>
<pre class='cython line score-0'>&#xA0;027: <span class="sd">&quot;&quot;&quot;modX labels for the 20 standard amino acids.&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;028: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+029: <span class="n">std_nterm</span> <span class="o">=</span> <span class="s">&#39;H-&#39;</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_H_2);
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_v_9pyteomics_7cparser_std_nterm);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_9pyteomics_7cparser_std_nterm, __pyx_kp_s_H_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_H_2);
</pre><pre class='cython line score-0'>&#xA0;030: <span class="sd">&quot;&quot;&quot;modX label for the unmodified N-terminus.&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;031: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+032: <span class="n">std_cterm</span> <span class="o">=</span> <span class="s">&#39;-OH&#39;</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_OH);
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_v_9pyteomics_7cparser_std_cterm);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_9pyteomics_7cparser_std_cterm, __pyx_kp_s_OH);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_OH);
</pre><pre class='cython line score-0'>&#xA0;033: <span class="sd">&quot;&quot;&quot;modX label for the unmodified C-terminus.&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;034: </pre>
<pre class='cython line score-16' onclick='toggleDiv(this)'>+035: <span class="n">std_labels</span> <span class="o">=</span> <span class="n">std_amino_acids</span> <span class="o">+</span> <span class="p">[</span><span class="n">std_nterm</span><span class="p">,</span> <span class="n">std_cterm</span><span class="p">]</span></pre>
<pre class='cython code score-16'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_nterm);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_9pyteomics_7cparser_std_nterm);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_9pyteomics_7cparser_std_nterm);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_cterm);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_9pyteomics_7cparser_std_cterm);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_9pyteomics_7cparser_std_cterm);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_9pyteomics_7cparser_std_amino_acids, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 35; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_v_9pyteomics_7cparser_std_labels);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_9pyteomics_7cparser_std_labels, ((PyObject*)__pyx_t_2));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;036: <span class="sd">&quot;&quot;&quot;modX labels for the standard amino acids and unmodified termini.&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;037: </pre>
<pre class='cython line score-14' onclick='toggleDiv(this)'>+038: <span class="n">_modX_sequence</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;^([^-]+-)?((?:[a-z]*[A-Z])+)(-[^-]+)?$&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-14'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_re);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_compile);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_v_9pyteomics_7cparser__modX_sequence);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_9pyteomics_7cparser__modX_sequence, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_a_z_A_Z);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 38; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+039: <span class="n">_modX_group</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;[a-z]*[A-Z]&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-14'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_re);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_compile);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_v_9pyteomics_7cparser__modX_group);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_9pyteomics_7cparser__modX_group, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_a_z_A_Z_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 39; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+040: <span class="n">_modX_split</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;([a-z]*)([A-Z])&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-14'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_re);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_compile);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_v_9pyteomics_7cparser__modX_split);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_9pyteomics_7cparser__modX_split, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_a_z_A_Z_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 40; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
</pre><pre class='cython line score-0'>&#xA0;041: </pre>
<pre class='cython line score-0'>&#xA0;042: </pre>
<pre class='cython line score-12' onclick='toggleDiv(this)'>+043: <span class="k">cpdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">is_term_mod</span><span class="p">(</span><span class="nb">str</span> <span class="n">label</span><span class="p">):</span></pre>
<pre class='cython code score-12'>static PyObject *__pyx_pw_9pyteomics_7cparser_1is_term_mod(PyObject *__pyx_self, PyObject *__pyx_v_label); /*proto*/
static CYTHON_INLINE int __pyx_f_9pyteomics_7cparser_is_term_mod(PyObject *__pyx_v_label, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_term_mod", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("pyteomics.cparser.is_term_mod", __pyx_clineno, __pyx_lineno, __pyx_filename, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_9pyteomics_7cparser_1is_term_mod(PyObject *__pyx_self, PyObject *__pyx_v_label); /*proto*/
static char __pyx_doc_9pyteomics_7cparser_is_term_mod[] = "Check if `label` corresponds to a terminal modification.\n\n    Parameters\n    ----------\n    label : str\n\n    Returns\n    -------\n    out : bool\n    ";
static PyObject *__pyx_pw_9pyteomics_7cparser_1is_term_mod(PyObject *__pyx_self, PyObject *__pyx_v_label) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_term_mod (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_label), (&amp;PyString_Type), 1, "label", 1))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_9pyteomics_7cparser_is_term_mod(__pyx_self, ((PyObject*)__pyx_v_label));
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9pyteomics_7cparser_is_term_mod(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_label) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_term_mod", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_9pyteomics_7cparser_is_term_mod(__pyx_v_label, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 43; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser.is_term_mod", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;044:     <span class="sd">&quot;&quot;&quot;Check if `label` corresponds to a terminal modification.</span></pre>
<pre class='cython line score-0'>&#xA0;045: </pre>
<pre class='cython line score-0'>&#xA0;046: <span class="sd">    Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;047: <span class="sd">    ----------</span></pre>
<pre class='cython line score-0'>&#xA0;048: <span class="sd">    label : str</span></pre>
<pre class='cython line score-0'>&#xA0;049: </pre>
<pre class='cython line score-0'>&#xA0;050: <span class="sd">    Returns</span></pre>
<pre class='cython line score-0'>&#xA0;051: <span class="sd">    -------</span></pre>
<pre class='cython line score-0'>&#xA0;052: <span class="sd">    out : bool</span></pre>
<pre class='cython line score-0'>&#xA0;053: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-36' onclick='toggleDiv(this)'>+054:     <span class="k">return</span> <span class="p">(</span><span class="n">PySequence_GetItem</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;-&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">PySequence_GetItem</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;-&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-36'>  __pyx_t_2 = <span class='py_c_api'>PySequence_GetItem</span>(__pyx_v_label, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_kp_s_, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (!__pyx_t_4) {
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = __pyx_t_5;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L3_bool_binop_done;
  }
  __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_label);<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='py_c_api'>PySequence_GetItem</span>(__pyx_v_label, (__pyx_t_6 - 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_kp_s_, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = __pyx_t_5;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_L3_bool_binop_done:;
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;055: </pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+056: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">object</span> <span class="nf">match_modX</span><span class="p">(</span><span class="nb">str</span> <span class="n">label</span><span class="p">):</span></pre>
<pre class='cython code score-4'>static CYTHON_INLINE PyObject *__pyx_f_9pyteomics_7cparser_match_modX(PyObject *__pyx_v_label) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("match_modX", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser.match_modX", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;057:     <span class="sd">&quot;&quot;&quot;Check if `label` is a valid &#39;modX&#39; label.</span></pre>
<pre class='cython line score-0'>&#xA0;058: </pre>
<pre class='cython line score-0'>&#xA0;059: <span class="sd">    Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;060: <span class="sd">    ----------</span></pre>
<pre class='cython line score-0'>&#xA0;061: <span class="sd">    label : str</span></pre>
<pre class='cython line score-0'>&#xA0;062: </pre>
<pre class='cython line score-0'>&#xA0;063: <span class="sd">    Returns</span></pre>
<pre class='cython line score-0'>&#xA0;064: <span class="sd">    -------</span></pre>
<pre class='cython line score-0'>&#xA0;065: <span class="sd">    out : re.match or None</span></pre>
<pre class='cython line score-0'>&#xA0;066: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+067:     <span class="k">return</span> <span class="n">PyObject_CallMethodObjArgs</span><span class="p">(</span><span class="n">_modX_split</span><span class="p">,</span> <span class="s">&quot;match&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">PyObject</span><span class="o">*&gt;</span><span class="n">label</span><span class="p">,</span> <span class="bp">NULL</span><span class="p">)</span></pre>
<pre class='cython code score-8'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_v_9pyteomics_7cparser__modX_split;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_CallMethodObjArgs</span>(__pyx_t_1, __pyx_n_s_match, ((PyObject *)__pyx_v_label), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;068: </pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+069: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">is_modX</span><span class="p">(</span><span class="nb">str</span> <span class="n">label</span><span class="p">):</span></pre>
<pre class='cython code score-3'>static CYTHON_INLINE int __pyx_f_9pyteomics_7cparser_is_modX(PyObject *__pyx_v_label) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_modX", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("pyteomics.cparser.is_modX", __pyx_clineno, __pyx_lineno, __pyx_filename, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;070:     <span class="sd">&quot;&quot;&quot;Check if `label` is a valid &#39;modX&#39; label.</span></pre>
<pre class='cython line score-0'>&#xA0;071: </pre>
<pre class='cython line score-0'>&#xA0;072: <span class="sd">    Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;073: <span class="sd">    ----------</span></pre>
<pre class='cython line score-0'>&#xA0;074: <span class="sd">    label : str</span></pre>
<pre class='cython line score-0'>&#xA0;075: </pre>
<pre class='cython line score-0'>&#xA0;076: <span class="sd">    Returns</span></pre>
<pre class='cython line score-0'>&#xA0;077: <span class="sd">    -------</span></pre>
<pre class='cython line score-0'>&#xA0;078: <span class="sd">    out : bool</span></pre>
<pre class='cython line score-0'>&#xA0;079: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+080:     <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">match_modX</span><span class="p">(</span><span class="n">label</span><span class="p">))</span></pre>
<pre class='cython code score-3'>  __pyx_t_1 = __pyx_f_9pyteomics_7cparser_match_modX(__pyx_v_label);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = (!(!__pyx_t_2));
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;081: </pre>
<pre class='cython line score-73' onclick='toggleDiv(this)'>+082: <span class="k">cpdef</span> <span class="kt">int</span> <span class="nf">length</span><span class="p">(</span><span class="nb">object</span> <span class="n">sequence</span><span class="p">,</span></pre>
<pre class='cython code score-73'>static PyObject *__pyx_pw_9pyteomics_7cparser_3length(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_9pyteomics_7cparser_length(PyObject *__pyx_v_sequence, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_9pyteomics_7cparser_length *__pyx_optional_args) {
  int __pyx_v_show_unmodified_termini = ((int)0);
  int __pyx_v_split = ((int)0);
  int __pyx_v_allow_unknown_modifications = ((int)0);
  PyObject *__pyx_v_labels = __pyx_k__2;
  PyObject *__pyx_v_parsed_sequence = NULL;
  PyObject *__pyx_v_num_term_groups = NULL;
  PyObject *__pyx_v_aa = NULL;
  PyObject *__pyx_v_amount = NULL;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("length", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_show_unmodified_termini = __pyx_optional_args-&gt;show_unmodified_termini;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_split = __pyx_optional_args-&gt;split;
        if (__pyx_optional_args-&gt;__pyx_n &gt; 2) {
          __pyx_v_allow_unknown_modifications = __pyx_optional_args-&gt;allow_unknown_modifications;
          if (__pyx_optional_args-&gt;__pyx_n &gt; 3) {
            __pyx_v_labels = __pyx_optional_args-&gt;labels;
          }
        }
      }
    }
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("pyteomics.cparser.length", __pyx_clineno, __pyx_lineno, __pyx_filename, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_parsed_sequence);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_term_groups);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_aa);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_amount);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_9pyteomics_7cparser_3length(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_9pyteomics_7cparser_2length[] = "Calculate the number of amino acid residues in a polypeptide\n    written in modX notation.\n\n    Parameters\n    ----------\n    sequence : str or list or dict\n        A string with a polypeptide sequence, a list with a parsed sequence or\n        a dict of amino acid composition.\n    labels : list, optional\n        A list of allowed labels for amino acids and terminal modifications.\n\n    Examples\n    --------\n    &gt;&gt;&gt; length('PEPTIDE')\n    7\n    &gt;&gt;&gt; length('H-PEPTIDE-OH')\n    7\n    ";
static PyObject *__pyx_pw_9pyteomics_7cparser_3length(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_sequence = 0;
  int __pyx_v_show_unmodified_termini;
  int __pyx_v_split;
  int __pyx_v_allow_unknown_modifications;
  PyObject *__pyx_v_labels = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("length (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_sequence,&amp;__pyx_n_s_show_unmodified_termini,&amp;__pyx_n_s_split,&amp;__pyx_n_s_allow_unknown_modifications,&amp;__pyx_n_s_labels,0};
    PyObject* values[5] = {0,0,0,0,0};
    values[4] = __pyx_k__2;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sequence)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_show_unmodified_termini);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_split);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_allow_unknown_modifications);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_labels);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "length") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_sequence = values[0];
    if (values[1]) {
      __pyx_v_show_unmodified_termini = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_show_unmodified_termini == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_show_unmodified_termini = ((int)0);
    }
    if (values[2]) {
      __pyx_v_split = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_split == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_split = ((int)0);
    }
    if (values[3]) {
      __pyx_v_allow_unknown_modifications = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_allow_unknown_modifications == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_allow_unknown_modifications = ((int)0);
    }
    __pyx_v_labels = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("length", 0, 1, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser.length", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9pyteomics_7cparser_2length(__pyx_self, __pyx_v_sequence, __pyx_v_show_unmodified_termini, __pyx_v_split, __pyx_v_allow_unknown_modifications, __pyx_v_labels);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9pyteomics_7cparser_2length(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_sequence, int __pyx_v_show_unmodified_termini, int __pyx_v_split, int __pyx_v_allow_unknown_modifications, PyObject *__pyx_v_labels) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("length", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 4;
  __pyx_t_2.show_unmodified_termini = __pyx_v_show_unmodified_termini;
  __pyx_t_2.split = __pyx_v_split;
  __pyx_t_2.allow_unknown_modifications = __pyx_v_allow_unknown_modifications;
  __pyx_t_2.labels = __pyx_v_labels;
  __pyx_t_1 = __pyx_f_9pyteomics_7cparser_length(__pyx_v_sequence, 0, &amp;__pyx_t_2); 
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 82; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser.length", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;083:                  <span class="nb">int</span> <span class="n">show_unmodified_termini</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="nb">int</span> <span class="n">split</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+084:                  <span class="nb">int</span> <span class="n">allow_unknown_modifications</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="nb">object</span> <span class="n">labels</span><span class="o">=</span><span class="n">std_labels</span><span class="p">):</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_labels);
  __pyx_k__2 = __pyx_v_9pyteomics_7cparser_std_labels;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_9pyteomics_7cparser_std_labels);
/* … */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_labels);
  __pyx_k__2 = __pyx_v_9pyteomics_7cparser_std_labels;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_9pyteomics_7cparser_std_labels);
</pre><pre class='cython line score-0'>&#xA0;085:     <span class="sd">&quot;&quot;&quot;Calculate the number of amino acid residues in a polypeptide</span></pre>
<pre class='cython line score-0'>&#xA0;086: <span class="sd">    written in modX notation.</span></pre>
<pre class='cython line score-0'>&#xA0;087: </pre>
<pre class='cython line score-0'>&#xA0;088: <span class="sd">    Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;089: <span class="sd">    ----------</span></pre>
<pre class='cython line score-0'>&#xA0;090: <span class="sd">    sequence : str or list or dict</span></pre>
<pre class='cython line score-0'>&#xA0;091: <span class="sd">        A string with a polypeptide sequence, a list with a parsed sequence or</span></pre>
<pre class='cython line score-0'>&#xA0;092: <span class="sd">        a dict of amino acid composition.</span></pre>
<pre class='cython line score-0'>&#xA0;093: <span class="sd">    labels : list, optional</span></pre>
<pre class='cython line score-0'>&#xA0;094: <span class="sd">        A list of allowed labels for amino acids and terminal modifications.</span></pre>
<pre class='cython line score-0'>&#xA0;095: </pre>
<pre class='cython line score-0'>&#xA0;096: <span class="sd">    Examples</span></pre>
<pre class='cython line score-0'>&#xA0;097: <span class="sd">    --------</span></pre>
<pre class='cython line score-0'>&#xA0;098: <span class="sd">    &gt;&gt;&gt; length(&#39;PEPTIDE&#39;)</span></pre>
<pre class='cython line score-0'>&#xA0;099: <span class="sd">    7</span></pre>
<pre class='cython line score-0'>&#xA0;100: <span class="sd">    &gt;&gt;&gt; length(&#39;H-PEPTIDE-OH&#39;)</span></pre>
<pre class='cython line score-0'>&#xA0;101: <span class="sd">    7</span></pre>
<pre class='cython line score-0'>&#xA0;102: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+103:     <span class="k">if</span> <span class="ow">not</span> <span class="n">sequence</span><span class="p">:</span> <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-2'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_sequence);<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = ((!__pyx_t_1) != 0);
  if (__pyx_t_2) {
    __pyx_r = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;104: </pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+105:     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span></pre>
<pre class='cython code score-10'>  __pyx_t_1 = <span class='py_c_api'>PyString_Check</span>(__pyx_v_sequence); 
  __pyx_t_3 = (__pyx_t_1 != 0);
  if (!__pyx_t_3) {
  } else {
    __pyx_t_2 = __pyx_t_3;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_3 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_sequence); 
  __pyx_t_1 = (__pyx_t_3 != 0);
  __pyx_t_2 = __pyx_t_1;
  __pyx_L5_bool_binop_done:;
  if (__pyx_t_2) {
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+106:         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span></pre>
<pre class='cython code score-5'>    __pyx_t_2 = <span class='py_c_api'>PyString_Check</span>(__pyx_v_sequence); 
    __pyx_t_1 = (__pyx_t_2 != 0);
    if (__pyx_t_1) {
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+107:             <span class="n">parsed_sequence</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">show_unmodified_termini</span><span class="p">,</span></pre>
<pre class='cython code score-10'>      if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_v_sequence))||((__pyx_v_sequence) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(__pyx_v_sequence)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
/* … */
      __pyx_t_5.__pyx_n = 4;
      __pyx_t_5.show_unmodified_termini = __pyx_v_show_unmodified_termini;
      __pyx_t_5.split = __pyx_v_split;
      __pyx_t_5.allow_unknown_modifications = __pyx_v_allow_unknown_modifications;
      __pyx_t_5.labels = __pyx_v_labels;
      __pyx_t_4 = __pyx_f_9pyteomics_7cparser_parse(((PyObject*)__pyx_v_sequence), 0, &amp;__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_v_parsed_sequence = __pyx_t_4;
      __pyx_t_4 = 0;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;108:                                     <span class="n">split</span><span class="p">,</span> <span class="n">allow_unknown_modifications</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;109:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+110:             <span class="n">parsed_sequence</span> <span class="o">=</span> <span class="n">sequence</span></pre>
<pre class='cython code score-1'>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sequence);
      __pyx_v_parsed_sequence = __pyx_v_sequence;
    }
    __pyx_L7:;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+111:         <span class="n">num_term_groups</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-1'>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_v_num_term_groups = __pyx_int_0;
</pre><pre class='cython line score-13' onclick='toggleDiv(this)'>+112:         <span class="k">if</span> <span class="n">is_term_mod</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-13'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_parsed_sequence, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_t_4))||((__pyx_t_4) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(__pyx_t_4)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = (__pyx_f_9pyteomics_7cparser_is_term_mod(((PyObject*)__pyx_t_4), 0) != 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_1) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+113:             <span class="n">num_term_groups</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-6'>      __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_num_term_groups, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_num_term_groups, __pyx_t_4);
      __pyx_t_4 = 0;
      goto __pyx_L8;
    }
    __pyx_L8:;
</pre><pre class='cython line score-13' onclick='toggleDiv(this)'>+114:         <span class="k">if</span> <span class="n">is_term_mod</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-13'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_parsed_sequence, -1, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_t_4))||((__pyx_t_4) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(__pyx_t_4)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = (__pyx_f_9pyteomics_7cparser_is_term_mod(((PyObject*)__pyx_t_4), 0) != 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_1) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+115:             <span class="n">num_term_groups</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-6'>      __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_num_term_groups, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_num_term_groups, __pyx_t_4);
      __pyx_t_4 = 0;
      goto __pyx_L9;
    }
    __pyx_L9:;
</pre><pre class='cython line score-19' onclick='toggleDiv(this)'>+116:         <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">)</span> <span class="o">-</span> <span class="n">num_term_groups</span></pre>
<pre class='cython code score-19'>    __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_parsed_sequence);<span class='error_goto'> if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_v_num_term_groups);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_7);<span class='error_goto'> if (unlikely((__pyx_t_8 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_r = __pyx_t_8;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+117:     <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyDict_Check</span>(__pyx_v_sequence); 
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-132' onclick='toggleDiv(this)'>+118:         <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">amount</span> <span class="k">for</span> <span class="n">aa</span><span class="p">,</span> <span class="n">amount</span> <span class="ow">in</span> <span class="n">sequence</span><span class="o">.</span><span class="n">items</span><span class="p">()</span></pre>
<pre class='cython code score-132'>    __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_sequence, __pyx_n_s_items);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_10 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    if (__pyx_t_10) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    } else {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      __pyx_t_9 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_6 = 0;
      __pyx_t_11 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_11 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    for (;;) {
      if (likely(!__pyx_t_11)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_6++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        }
      } else {
        __pyx_t_4 = __pyx_t_11(__pyx_t_9);
        if (unlikely(!__pyx_t_4)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        PyObject* sequence = __pyx_t_4;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        #else
        __pyx_t_10 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_12 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_13 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_14 = Py_TYPE(__pyx_t_13)-&gt;tp_iternext;
        index = 0; __pyx_t_10 = __pyx_t_14(__pyx_t_13); if (unlikely(!__pyx_t_10)) goto __pyx_L12_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        index = 1; __pyx_t_12 = __pyx_t_14(__pyx_t_13); if (unlikely(!__pyx_t_12)) goto __pyx_L12_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_14(__pyx_t_13), 2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_14 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        goto __pyx_L13_unpacking_done;
        __pyx_L12_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        __pyx_t_14 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L13_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_aa, __pyx_t_10);
      __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_amount, __pyx_t_12);
      __pyx_t_12 = 0;
/* … */
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_7, (PyObject*)__pyx_v_amount))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L14;
      }
      __pyx_L14:;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_sum, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_7);<span class='error_goto'> if (unlikely((__pyx_t_8 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_r = __pyx_t_8;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+119:                     <span class="k">if</span> <span class="ow">not</span> <span class="n">is_term_mod</span><span class="p">(</span><span class="n">aa</span><span class="p">)])</span></pre>
<pre class='cython code score-10'>      if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_v_aa))||((__pyx_v_aa) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(__pyx_v_aa)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_2 = ((!(__pyx_f_9pyteomics_7cparser_is_term_mod(((PyObject*)__pyx_v_aa), 0) != 0)) != 0);
      if (__pyx_t_2) {
</pre><pre class='cython line score-0'>&#xA0;120: </pre>
<pre class='cython line score-13' onclick='toggleDiv(this)'>+121:     <span class="k">raise</span> <span class="n">PyteomicsError</span><span class="p">(</span><span class="s">&#39;Unsupported type of sequence.&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-13'>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_PyteomicsError);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_tuple__3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_9, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
/* … */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Unsupported_type_of_sequence);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class='cython line score-0'>&#xA0;122: </pre>
<pre class='cython line score-0'>&#xA0;123: </pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+124: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">list</span> <span class="nf">interpolate_labels</span><span class="p">(</span><span class="nb">object</span> <span class="n">labels</span><span class="p">):</span></pre>
<pre class='cython code score-4'>static CYTHON_INLINE PyObject *__pyx_f_9pyteomics_7cparser_interpolate_labels(PyObject *__pyx_v_labels) {
  PyObject *__pyx_v__labels = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("interpolate_labels", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser.interpolate_labels", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__labels);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;125:     <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">_labels</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+126:     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_labels); 
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+127:         <span class="n">_labels</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">list</span><span class="p">&gt;</span><span class="n">labels</span></pre>
<pre class='cython code score-1'>    __pyx_t_3 = __pyx_v_labels;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_v__labels = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;128:     <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+129:         <span class="n">_labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span></pre>
<pre class='cython code score-5'>    __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_v_labels);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 129; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_v__labels = ((PyObject*)__pyx_t_3);
    __pyx_t_3 = 0;
  }
  __pyx_L3:;
</pre><pre class='cython line score-17' onclick='toggleDiv(this)'>+130:     <span class="n">_labels</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">std_cterm</span><span class="p">,</span> <span class="n">std_nterm</span><span class="p">))</span></pre>
<pre class='cython code score-17'>  if (unlikely(__pyx_v__labels == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "extend");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_cterm);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_9pyteomics_7cparser_std_cterm);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_9pyteomics_7cparser_std_cterm);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_nterm);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_9pyteomics_7cparser_std_nterm);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_9pyteomics_7cparser_std_nterm);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyList_Extend</span>(__pyx_v__labels, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+131:     <span class="k">return</span> <span class="n">_labels</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v__labels);
  __pyx_r = __pyx_v__labels;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;132: </pre>
<pre class='cython line score-0'>&#xA0;133: </pre>
<pre class='cython line score-16' onclick='toggleDiv(this)'>+134: <span class="k">cpdef</span> <span class="kr">inline</span> <span class="kt">tuple</span> <span class="nf">_split_label</span><span class="p">(</span><span class="nb">str</span> <span class="n">label</span><span class="p">):</span></pre>
<pre class='cython code score-16'>static PyObject *__pyx_pw_9pyteomics_7cparser_5_split_label(PyObject *__pyx_self, PyObject *__pyx_v_label); /*proto*/
static CYTHON_INLINE PyObject *__pyx_f_9pyteomics_7cparser__split_label(PyObject *__pyx_v_label, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_v_mod = 0;
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_temp = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_split_label", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser._split_label", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mod);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_temp);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_9pyteomics_7cparser_5_split_label(PyObject *__pyx_self, PyObject *__pyx_v_label); /*proto*/
static PyObject *__pyx_pw_9pyteomics_7cparser_5_split_label(PyObject *__pyx_self, PyObject *__pyx_v_label) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_split_label (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_label), (&amp;PyString_Type), 1, "label", 1))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_9pyteomics_7cparser_4_split_label(__pyx_self, ((PyObject*)__pyx_v_label));
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9pyteomics_7cparser_4_split_label(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_label) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_split_label", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_9pyteomics_7cparser__split_label(__pyx_v_label, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser._split_label", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;135:     <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;136:         <span class="nb">str</span> <span class="n">mod</span><span class="p">,</span> <span class="n">X</span></pre>
<pre class='cython line score-0'>&#xA0;137:         <span class="nb">tuple</span> <span class="n">temp</span></pre>
<pre class='cython line score-0'>&#xA0;138: </pre>
<pre class='cython line score-0'>&#xA0;139: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+140:     <span class="n">temp</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">tuple</span><span class="p">&gt;</span><span class="n">PyObject_CallMethodObjArgs</span><span class="p">(</span><span class="n">match_modX</span><span class="p">(</span><span class="n">label</span><span class="p">),</span> <span class="s">&quot;groups&quot;</span><span class="p">,</span> <span class="bp">NULL</span><span class="p">)</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = __pyx_f_9pyteomics_7cparser_match_modX(__pyx_v_label);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_CallMethodObjArgs</span>(__pyx_t_1, __pyx_n_s_groups, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_t_2;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_temp = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+141:     <span class="k">if</span> <span class="o">&lt;</span><span class="n">PyObject</span><span class="o">*&gt;</span><span class="n">temp</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = ((((PyObject *)__pyx_v_temp) == NULL) != 0);
  if (__pyx_t_3) {
</pre><pre class='cython line score-31' onclick='toggleDiv(this)'>+142:         <span class="k">raise</span> <span class="n">PyteomicsError</span><span class="p">(</span><span class="s">&#39;Cannot split a non-modX label: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">label</span><span class="p">)</span></pre>
<pre class='cython code score-31'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_PyteomicsError);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Cannot_split_a_non_modX_label_s, __pyx_v_label);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    if (!__pyx_t_5) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); __pyx_t_5 = NULL;
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+143:     <span class="n">mod</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">str</span><span class="p">&gt;</span><span class="n">PyTuple_GET_ITEM</span><span class="p">(&lt;</span><span class="kt">tuple</span><span class="p">&gt;</span><span class="n">temp</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-2'>  __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_v_temp, 0);
  __pyx_t_1 = ((PyObject *)__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_mod = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+144:     <span class="n">X</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">str</span><span class="p">&gt;</span><span class="n">PyTuple_GET_ITEM</span><span class="p">(&lt;</span><span class="kt">tuple</span><span class="p">&gt;</span><span class="n">temp</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-2'>  __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_v_temp, 1);
  __pyx_t_1 = ((PyObject *)__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_X = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+145:     <span class="k">if</span> <span class="ow">not</span> <span class="n">mod</span><span class="p">:</span></pre>
<pre class='cython code score-2'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_mod);<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_8 = ((!__pyx_t_3) != 0);
  if (__pyx_t_8) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+146:         <span class="k">return</span> <span class="p">(</span><span class="n">X</span><span class="p">,)</span></pre>
<pre class='cython code score-8'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_X);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X);
    __pyx_r = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;147:     <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+148:         <span class="k">return</span> <span class="n">temp</span></pre>
<pre class='cython code score-2'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_temp);
    __pyx_r = __pyx_v_temp;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;149: </pre>
<pre class='cython line score-0'>&#xA0;150: </pre>
<pre class='cython line score-84' onclick='toggleDiv(this)'>+151: <span class="k">cpdef</span> <span class="kt">list</span> <span class="nf">parse</span><span class="p">(</span><span class="nb">str</span> <span class="n">sequence</span><span class="p">,</span> <span class="nb">int</span> <span class="n">show_unmodified_termini</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="nb">int</span> <span class="n">split</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span></pre>
<pre class='cython code score-84'>static PyObject *__pyx_pw_9pyteomics_7cparser_7parse(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_9pyteomics_7cparser_parse(PyObject *__pyx_v_sequence, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_9pyteomics_7cparser_parse *__pyx_optional_args) {
  int __pyx_v_show_unmodified_termini = ((int)0);
  int __pyx_v_split = ((int)0);
  int __pyx_v_allow_unknown_modifications = ((int)0);
  PyObject *__pyx_v_labels = __pyx_k__4;
  PyObject *__pyx_v_match = 0;
  PyObject *__pyx_v_temp = 0;
  PyObject *__pyx_v_n = 0;
  PyObject *__pyx_v_body = 0;
  PyObject *__pyx_v_c = 0;
  PyObject *__pyx_v_nterm = 0;
  PyObject *__pyx_v_cterm = 0;
  PyObject *__pyx_v_mod = 0;
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_parsed_sequence = 0;
  PyObject *__pyx_v_tgroup = 0;
  PyObject *__pyx_v_sgroup = 0;
  PyObject *__pyx_v__labels = 0;
  PyObject *__pyx_v_slabels = 0;
  Py_ssize_t __pyx_v_i;
  int __pyx_v_is_mod;
  int __pyx_v_in_labels;
  PyObject *__pyx_v_g = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("parse", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_show_unmodified_termini = __pyx_optional_args-&gt;show_unmodified_termini;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_split = __pyx_optional_args-&gt;split;
        if (__pyx_optional_args-&gt;__pyx_n &gt; 2) {
          __pyx_v_allow_unknown_modifications = __pyx_optional_args-&gt;allow_unknown_modifications;
          if (__pyx_optional_args-&gt;__pyx_n &gt; 3) {
            __pyx_v_labels = __pyx_optional_args-&gt;labels;
          }
        }
      }
    }
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser.parse", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_match);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_temp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_body);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_c);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nterm);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cterm);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mod);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_parsed_sequence);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tgroup);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sgroup);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__labels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_slabels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_g);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_9pyteomics_7cparser_7parse(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_9pyteomics_7cparser_6parse[] = "Parse a sequence string written in modX notation into a list of\n    labels or (if `split` argument is :py:const:`True`) into a list of\n    tuples representing amino acid residues and their modifications.\n\n    Parameters\n    ----------\n    sequence : str\n        The sequence of a polypeptide.\n    show_unmodified_termini : bool, optional\n        If :py:const:`True` then the unmodified N- and C-termini are explicitly\n        shown in the returned list. Default value is :py:const:`False`.\n    split : bool, optional\n        If :py:const:`True` then the result will be a list of tuples with 1 to 4\n        elements: terminal modification, modification, residue. Default value is\n        :py:const:`False`.\n    allow_unknown_modifications : bool, optional\n        If :py:const:`True` then do not raise an exception when an unknown\n        modification of a known amino acid residue is found in the sequence.\n        This also includes terminal groups.\n        Default value is :py:const:`False`.\n\n        .. note::\n            Since version 2.5, this parameter has effect only if `labels`\n            are provided.\n    labels : container, optional\n        A container of allowed labels for amino acids,\n        modifications and terminal modifications.\n        If not provided, no checks will be done.\n        Separate labels for modifications (such as 'p' or 'ox')\n        can be supplied, which means they are applicable to all residues.\n\n        .. warning::\n            If `show_unmodified_termini` is set to :py:const:`True`, standard\n            terminal groups need to be present in `labels`.\n\n        .. warning::\n            Avoid using sequences with only one terminal group, as they are\n            ambiguous. If you provide one, `labels` (or :py:const:`std_labels`)\n            will be used to resolve the ambiguity.\n\n    Returns\n    -------\n    out : list\n        List of tuples with labels of modifications and amino acid residues.\n\n    Examp""les\n    --------\n    &gt;&gt;&gt; parse('PEPTIDE', split=True)\n    [('P',), ('E',), ('P',), ('T',), ('I',), ('D',), ('E',)]\n    &gt;&gt;&gt; parse('H-PEPTIDE')\n    ['P', 'E', 'P', 'T', 'I', 'D', 'E']\n    &gt;&gt;&gt; parse('PEPTIDE', show_unmodified_termini=True)\n    ['H-', 'P', 'E', 'P', 'T', 'I', 'D', 'E', '-OH']\n    &gt;&gt;&gt; parse('TEpSToxM', labels=std_labels + ['pS', 'oxM'])\n    ['T', 'E', 'pS', 'T', 'oxM']\n    &gt;&gt;&gt; parse('zPEPzTIDzE', True, True, labels=std_labels+['z'])\n    [('H-', 'z', 'P'), ('E',), ('P',), ('z', 'T'), ('I',), ('D',), ('z', 'E', '-OH')]\n    ";
static PyObject *__pyx_pw_9pyteomics_7cparser_7parse(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_sequence = 0;
  int __pyx_v_show_unmodified_termini;
  int __pyx_v_split;
  int __pyx_v_allow_unknown_modifications;
  PyObject *__pyx_v_labels = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("parse (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_sequence,&amp;__pyx_n_s_show_unmodified_termini,&amp;__pyx_n_s_split,&amp;__pyx_n_s_allow_unknown_modifications,&amp;__pyx_n_s_labels,0};
    PyObject* values[5] = {0,0,0,0,0};
    values[4] = __pyx_k__4;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sequence)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_show_unmodified_termini);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_split);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_allow_unknown_modifications);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_labels);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "parse") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_sequence = ((PyObject*)values[0]);
    if (values[1]) {
      __pyx_v_show_unmodified_termini = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_show_unmodified_termini == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_show_unmodified_termini = ((int)0);
    }
    if (values[2]) {
      __pyx_v_split = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_split == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_split = ((int)0);
    }
    if (values[3]) {
      __pyx_v_allow_unknown_modifications = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_allow_unknown_modifications == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 152; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_allow_unknown_modifications = ((int)0);
    }
    __pyx_v_labels = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("parse", 0, 1, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser.parse", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_sequence), (&amp;PyString_Type), 1, "sequence", 1))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_9pyteomics_7cparser_6parse(__pyx_self, __pyx_v_sequence, __pyx_v_show_unmodified_termini, __pyx_v_split, __pyx_v_allow_unknown_modifications, __pyx_v_labels);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9pyteomics_7cparser_6parse(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_sequence, int __pyx_v_show_unmodified_termini, int __pyx_v_split, int __pyx_v_allow_unknown_modifications, PyObject *__pyx_v_labels) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("parse", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 4;
  __pyx_t_2.show_unmodified_termini = __pyx_v_show_unmodified_termini;
  __pyx_t_2.split = __pyx_v_split;
  __pyx_t_2.allow_unknown_modifications = __pyx_v_allow_unknown_modifications;
  __pyx_t_2.labels = __pyx_v_labels;
  __pyx_t_1 = __pyx_f_9pyteomics_7cparser_parse(__pyx_v_sequence, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser.parse", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+152:                 <span class="nb">int</span> <span class="n">allow_unknown_modifications</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="nb">object</span> <span class="n">labels</span><span class="o">=</span><span class="n">std_labels</span><span class="p">):</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_labels);
  __pyx_k__4 = __pyx_v_9pyteomics_7cparser_std_labels;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_9pyteomics_7cparser_std_labels);
/* … */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_labels);
  __pyx_k__4 = __pyx_v_9pyteomics_7cparser_std_labels;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_9pyteomics_7cparser_std_labels);
</pre><pre class='cython line score-0'>&#xA0;153:     <span class="sd">&quot;&quot;&quot;Parse a sequence string written in modX notation into a list of</span></pre>
<pre class='cython line score-0'>&#xA0;154: <span class="sd">    labels or (if `split` argument is :py:const:`True`) into a list of</span></pre>
<pre class='cython line score-0'>&#xA0;155: <span class="sd">    tuples representing amino acid residues and their modifications.</span></pre>
<pre class='cython line score-0'>&#xA0;156: </pre>
<pre class='cython line score-0'>&#xA0;157: <span class="sd">    Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;158: <span class="sd">    ----------</span></pre>
<pre class='cython line score-0'>&#xA0;159: <span class="sd">    sequence : str</span></pre>
<pre class='cython line score-0'>&#xA0;160: <span class="sd">        The sequence of a polypeptide.</span></pre>
<pre class='cython line score-0'>&#xA0;161: <span class="sd">    show_unmodified_termini : bool, optional</span></pre>
<pre class='cython line score-0'>&#xA0;162: <span class="sd">        If :py:const:`True` then the unmodified N- and C-termini are explicitly</span></pre>
<pre class='cython line score-0'>&#xA0;163: <span class="sd">        shown in the returned list. Default value is :py:const:`False`.</span></pre>
<pre class='cython line score-0'>&#xA0;164: <span class="sd">    split : bool, optional</span></pre>
<pre class='cython line score-0'>&#xA0;165: <span class="sd">        If :py:const:`True` then the result will be a list of tuples with 1 to 4</span></pre>
<pre class='cython line score-0'>&#xA0;166: <span class="sd">        elements: terminal modification, modification, residue. Default value is</span></pre>
<pre class='cython line score-0'>&#xA0;167: <span class="sd">        :py:const:`False`.</span></pre>
<pre class='cython line score-0'>&#xA0;168: <span class="sd">    allow_unknown_modifications : bool, optional</span></pre>
<pre class='cython line score-0'>&#xA0;169: <span class="sd">        If :py:const:`True` then do not raise an exception when an unknown</span></pre>
<pre class='cython line score-0'>&#xA0;170: <span class="sd">        modification of a known amino acid residue is found in the sequence.</span></pre>
<pre class='cython line score-0'>&#xA0;171: <span class="sd">        This also includes terminal groups.</span></pre>
<pre class='cython line score-0'>&#xA0;172: <span class="sd">        Default value is :py:const:`False`.</span></pre>
<pre class='cython line score-0'>&#xA0;173: </pre>
<pre class='cython line score-0'>&#xA0;174: <span class="sd">        .. note::</span></pre>
<pre class='cython line score-0'>&#xA0;175: <span class="sd">            Since version 2.5, this parameter has effect only if `labels`</span></pre>
<pre class='cython line score-0'>&#xA0;176: <span class="sd">            are provided.</span></pre>
<pre class='cython line score-0'>&#xA0;177: <span class="sd">    labels : container, optional</span></pre>
<pre class='cython line score-0'>&#xA0;178: <span class="sd">        A container of allowed labels for amino acids,</span></pre>
<pre class='cython line score-0'>&#xA0;179: <span class="sd">        modifications and terminal modifications.</span></pre>
<pre class='cython line score-0'>&#xA0;180: <span class="sd">        If not provided, no checks will be done.</span></pre>
<pre class='cython line score-0'>&#xA0;181: <span class="sd">        Separate labels for modifications (such as &#39;p&#39; or &#39;ox&#39;)</span></pre>
<pre class='cython line score-0'>&#xA0;182: <span class="sd">        can be supplied, which means they are applicable to all residues.</span></pre>
<pre class='cython line score-0'>&#xA0;183: </pre>
<pre class='cython line score-0'>&#xA0;184: <span class="sd">        .. warning::</span></pre>
<pre class='cython line score-0'>&#xA0;185: <span class="sd">            If `show_unmodified_termini` is set to :py:const:`True`, standard</span></pre>
<pre class='cython line score-0'>&#xA0;186: <span class="sd">            terminal groups need to be present in `labels`.</span></pre>
<pre class='cython line score-0'>&#xA0;187: </pre>
<pre class='cython line score-0'>&#xA0;188: <span class="sd">        .. warning::</span></pre>
<pre class='cython line score-0'>&#xA0;189: <span class="sd">            Avoid using sequences with only one terminal group, as they are</span></pre>
<pre class='cython line score-0'>&#xA0;190: <span class="sd">            ambiguous. If you provide one, `labels` (or :py:const:`std_labels`)</span></pre>
<pre class='cython line score-0'>&#xA0;191: <span class="sd">            will be used to resolve the ambiguity.</span></pre>
<pre class='cython line score-0'>&#xA0;192: </pre>
<pre class='cython line score-0'>&#xA0;193: <span class="sd">    Returns</span></pre>
<pre class='cython line score-0'>&#xA0;194: <span class="sd">    -------</span></pre>
<pre class='cython line score-0'>&#xA0;195: <span class="sd">    out : list</span></pre>
<pre class='cython line score-0'>&#xA0;196: <span class="sd">        List of tuples with labels of modifications and amino acid residues.</span></pre>
<pre class='cython line score-0'>&#xA0;197: </pre>
<pre class='cython line score-0'>&#xA0;198: <span class="sd">    Examples</span></pre>
<pre class='cython line score-0'>&#xA0;199: <span class="sd">    --------</span></pre>
<pre class='cython line score-0'>&#xA0;200: <span class="sd">    &gt;&gt;&gt; parse(&#39;PEPTIDE&#39;, split=True)</span></pre>
<pre class='cython line score-0'>&#xA0;201: <span class="sd">    [(&#39;P&#39;,), (&#39;E&#39;,), (&#39;P&#39;,), (&#39;T&#39;,), (&#39;I&#39;,), (&#39;D&#39;,), (&#39;E&#39;,)]</span></pre>
<pre class='cython line score-0'>&#xA0;202: <span class="sd">    &gt;&gt;&gt; parse(&#39;H-PEPTIDE&#39;)</span></pre>
<pre class='cython line score-0'>&#xA0;203: <span class="sd">    [&#39;P&#39;, &#39;E&#39;, &#39;P&#39;, &#39;T&#39;, &#39;I&#39;, &#39;D&#39;, &#39;E&#39;]</span></pre>
<pre class='cython line score-0'>&#xA0;204: <span class="sd">    &gt;&gt;&gt; parse(&#39;PEPTIDE&#39;, show_unmodified_termini=True)</span></pre>
<pre class='cython line score-0'>&#xA0;205: <span class="sd">    [&#39;H-&#39;, &#39;P&#39;, &#39;E&#39;, &#39;P&#39;, &#39;T&#39;, &#39;I&#39;, &#39;D&#39;, &#39;E&#39;, &#39;-OH&#39;]</span></pre>
<pre class='cython line score-0'>&#xA0;206: <span class="sd">    &gt;&gt;&gt; parse(&#39;TEpSToxM&#39;, labels=std_labels + [&#39;pS&#39;, &#39;oxM&#39;])</span></pre>
<pre class='cython line score-0'>&#xA0;207: <span class="sd">    [&#39;T&#39;, &#39;E&#39;, &#39;pS&#39;, &#39;T&#39;, &#39;oxM&#39;]</span></pre>
<pre class='cython line score-0'>&#xA0;208: <span class="sd">    &gt;&gt;&gt; parse(&#39;zPEPzTIDzE&#39;, True, True, labels=std_labels+[&#39;z&#39;])</span></pre>
<pre class='cython line score-0'>&#xA0;209: <span class="sd">    [(&#39;H-&#39;, &#39;z&#39;, &#39;P&#39;), (&#39;E&#39;,), (&#39;P&#39;,), (&#39;z&#39;, &#39;T&#39;), (&#39;I&#39;,), (&#39;D&#39;,), (&#39;z&#39;, &#39;E&#39;, &#39;-OH&#39;)]</span></pre>
<pre class='cython line score-0'>&#xA0;210: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;211: </pre>
<pre class='cython line score-0'>&#xA0;212:     <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;213:         <span class="nb">object</span> <span class="n">match</span></pre>
<pre class='cython line score-0'>&#xA0;214:         <span class="nb">tuple</span> <span class="n">temp</span></pre>
<pre class='cython line score-0'>&#xA0;215:         <span class="nb">str</span> <span class="n">n</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">nterm</span><span class="p">,</span> <span class="n">cterm</span><span class="p">,</span> <span class="n">mod</span><span class="p">,</span> <span class="n">X</span></pre>
<pre class='cython line score-0'>&#xA0;216:         <span class="nb">list</span> <span class="n">parsed_sequence</span></pre>
<pre class='cython line score-0'>&#xA0;217:         <span class="nb">tuple</span> <span class="n">tgroup</span></pre>
<pre class='cython line score-0'>&#xA0;218:         <span class="nb">str</span> <span class="n">sgroup</span></pre>
<pre class='cython line score-0'>&#xA0;219:         <span class="nb">list</span> <span class="n">_labels</span></pre>
<pre class='cython line score-0'>&#xA0;220:         <span class="nb">set</span> <span class="n">slabels</span></pre>
<pre class='cython line score-0'>&#xA0;221:         <span class="n">Py_ssize_t</span> <span class="n">i</span></pre>
<pre class='cython line score-0'>&#xA0;222:         <span class="nb">int</span> <span class="n">is_mod</span><span class="p">,</span> <span class="n">is_residue</span><span class="p">,</span> <span class="n">in_labels</span></pre>
<pre class='cython line score-0'>&#xA0;223: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+224:     <span class="n">_labels</span> <span class="o">=</span> <span class="n">interpolate_labels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_f_9pyteomics_7cparser_interpolate_labels(__pyx_v_labels);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 224; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v__labels = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;225: </pre>
<pre class='cython line score-7' onclick='toggleDiv(this)'>+226:     <span class="n">match</span> <span class="o">=</span> <span class="n">PyObject_CallMethodObjArgs</span><span class="p">(</span><span class="n">_modX_sequence</span><span class="p">,</span> <span class="s">&quot;match&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">PyObject</span><span class="o">*&gt;</span><span class="n">sequence</span><span class="p">,</span> <span class="bp">NULL</span><span class="p">)</span></pre>
<pre class='cython code score-7'>  __pyx_t_1 = __pyx_v_9pyteomics_7cparser__modX_sequence;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_CallMethodObjArgs</span>(__pyx_t_1, __pyx_n_s_match, ((PyObject *)__pyx_v_sequence), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_match = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+227:     <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = (__pyx_v_match == Py_None);
  __pyx_t_4 = (__pyx_t_3 != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-34' onclick='toggleDiv(this)'>+228:         <span class="k">raise</span> <span class="n">PyteomicsError</span><span class="p">(</span><span class="s">&#39;Not a valid modX sequence: &#39;</span> <span class="o">+</span> <span class="n">sequence</span><span class="p">)</span></pre>
<pre class='cython code score-34'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_PyteomicsError);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_Not_a_valid_modX_sequence, __pyx_v_sequence);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    } else {
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='cython line score-7' onclick='toggleDiv(this)'>+229:     <span class="n">temp</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">tuple</span><span class="p">&gt;</span><span class="n">PyObject_CallMethodObjArgs</span><span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="s">&quot;groups&quot;</span><span class="p">,</span> <span class="bp">NULL</span><span class="p">)</span></pre>
<pre class='cython code score-7'>  __pyx_t_2 = <span class='py_c_api'>PyObject_CallMethodObjArgs</span>(__pyx_v_match, __pyx_n_s_groups, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = __pyx_t_2;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_temp = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+230:     <span class="n">n</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">str</span><span class="p">&gt;</span><span class="n">PyTuple_GET_ITEM</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-2'>  __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_v_temp, 0);
  __pyx_t_1 = ((PyObject *)__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_n = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+231:     <span class="n">body</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">str</span><span class="p">&gt;</span><span class="n">PyTuple_GET_ITEM</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-2'>  __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_v_temp, 1);
  __pyx_t_1 = ((PyObject *)__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_body = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+232:     <span class="n">c</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">str</span><span class="p">&gt;</span><span class="n">PyTuple_GET_ITEM</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-2'>  __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_v_temp, 2);
  __pyx_t_1 = ((PyObject *)__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_c = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+233:     <span class="n">slabels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">_labels</span><span class="p">)</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PySet_New</span>(__pyx_v__labels);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_slabels = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;234:     <span class="c"># labels help save the day when only one terminal group is given</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+235:     <span class="k">if</span> <span class="n">c</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">n</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = (__pyx_v_c == ((PyObject*)Py_None));
  __pyx_t_9 = (__pyx_t_3 != 0);
  if (__pyx_t_9) {
  } else {
    __pyx_t_4 = __pyx_t_9;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_9 = (__pyx_v_n != ((PyObject*)Py_None));
  __pyx_t_3 = (__pyx_t_9 != 0);
  __pyx_t_4 = __pyx_t_3;
  __pyx_L5_bool_binop_done:;
  if (__pyx_t_4) {
</pre><pre class='cython line score-0'>&#xA0;236:         <span class="c"># we can try to resolve the ambiguity</span></pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+237:         <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="n">std_nterm</span> <span class="ow">and</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">slabels</span><span class="p">:</span></pre>
<pre class='cython code score-4'>    __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_n, __pyx_v_9pyteomics_7cparser_std_nterm, Py_NE));<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = (__pyx_t_3 != 0);
    if (__pyx_t_9) {
    } else {
      __pyx_t_4 = __pyx_t_9;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_v_n, __pyx_v_slabels, Py_NE));<span class='error_goto'> if (unlikely(__pyx_t_9 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_3 = (__pyx_t_9 != 0);
    __pyx_t_4 = __pyx_t_3;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_4) {
</pre><pre class='cython line score-0'>&#xA0;238:             <span class="c"># n is the body then</span></pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+239:             <span class="n">c</span> <span class="o">=</span> <span class="s">&#39;-&#39;</span> <span class="o">+</span> <span class="n">body</span></pre>
<pre class='cython code score-6'>      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_, __pyx_v_body);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_c, ((PyObject*)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+240:             <span class="n">body</span> <span class="o">=</span> <span class="n">n</span><span class="p">[:</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-11'>      if (unlikely(__pyx_v_n == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_1 = <span class='py_c_api'>PySequence_GetSlice</span>(__pyx_v_n, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_body, ((PyObject*)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+241:             <span class="n">n</span> <span class="o">=</span> <span class="bp">None</span></pre>
<pre class='cython code score-2'>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_n, ((PyObject*)Py_None));
      goto __pyx_L7;
    }
    __pyx_L7:;
    goto __pyx_L4;
  }
  __pyx_L4:;
</pre><pre class='cython line score-0'>&#xA0;242: </pre>
<pre class='cython line score-0'>&#xA0;243:     <span class="c"># Actual parsing</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+244:     <span class="k">if</span> <span class="n">split</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_split != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-74' onclick='toggleDiv(this)'>+245:         <span class="n">parsed_sequence</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span> <span class="k">if</span> <span class="n">g</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="k">else</span> <span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="mf">1</span><span class="p">],)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span></pre>
<pre class='cython code score-74'>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_re);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_findall);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/* … */
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
      __pyx_t_5 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_10 = 0;
      __pyx_t_11 = NULL;
    } else {
      __pyx_t_10 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_11 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    for (;;) {
      if (likely(!__pyx_t_11)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
          if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_10++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        } else {
          if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_10++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #endif
        }
      } else {
        __pyx_t_2 = __pyx_t_11(__pyx_t_5);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_g, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_g, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (__pyx_t_4) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_g);
        __pyx_t_2 = __pyx_v_g;
      } else {
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_g, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_2 = __pyx_t_7;
        __pyx_t_7 = 0;
      }
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_2))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_parsed_sequence = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L10;
  }
  /*else*/ {
</pre><pre class='cython line score-24' onclick='toggleDiv(this)'>+246:             <span class="n">_modX_split</span><span class="p">,</span> <span class="n">body</span><span class="p">)]</span></pre>
<pre class='cython code score-24'>    __pyx_t_7 = NULL;
    __pyx_t_10 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_10 = 1;
      }
    }
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (__pyx_t_7) {
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_7); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); __pyx_t_7 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser__modX_split);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_10, __pyx_v_9pyteomics_7cparser__modX_split);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_9pyteomics_7cparser__modX_split);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_body);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_10, __pyx_v_body);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_body);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;247:     <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-9' onclick='toggleDiv(this)'>+248:         <span class="n">parsed_sequence</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">list</span><span class="p">&gt;</span><span class="n">PyObject_CallMethodObjArgs</span><span class="p">(</span><span class="n">_modX_group</span><span class="p">,</span> <span class="s">&quot;findall&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">PyObject</span><span class="o">*&gt;</span><span class="n">body</span><span class="p">,</span> <span class="bp">NULL</span><span class="p">)</span></pre>
<pre class='cython code score-9'>    __pyx_t_1 = __pyx_v_9pyteomics_7cparser__modX_group;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyObject_CallMethodObjArgs</span>(__pyx_t_1, __pyx_n_s_findall, ((PyObject *)__pyx_v_body), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_t_5;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_parsed_sequence = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
  }
  __pyx_L10:;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+249:     <span class="n">nterm</span><span class="p">,</span> <span class="n">cterm</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="ow">or</span> <span class="n">std_nterm</span><span class="p">),</span> <span class="p">(</span><span class="n">c</span> <span class="ow">or</span> <span class="n">std_cterm</span><span class="p">)</span></pre>
<pre class='cython code score-8'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (!__pyx_t_4) {
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n);
    __pyx_t_1 = __pyx_v_n;
    goto __pyx_L13_bool_binop_done;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_nterm);
  __pyx_t_1 = __pyx_v_9pyteomics_7cparser_std_nterm;
  __pyx_L13_bool_binop_done:;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_c);<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (!__pyx_t_4) {
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_c);
    __pyx_t_5 = __pyx_v_c;
    goto __pyx_L15_bool_binop_done;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_cterm);
  __pyx_t_5 = __pyx_v_9pyteomics_7cparser_std_cterm;
  __pyx_L15_bool_binop_done:;
  __pyx_v_nterm = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_cterm = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;250: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+251:     <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_unknown_modifications</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = ((!(__pyx_v_allow_unknown_modifications != 0)) != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+252:         <span class="k">if</span> <span class="n">nterm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">nterm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">slabels</span><span class="p">:</span></pre>
<pre class='cython code score-2'>    __pyx_t_3 = (__pyx_v_nterm != ((PyObject*)Py_None));
    __pyx_t_9 = (__pyx_t_3 != 0);
    if (__pyx_t_9) {
    } else {
      __pyx_t_4 = __pyx_t_9;
      goto __pyx_L19_bool_binop_done;
    }
    __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_v_nterm, __pyx_v_slabels, Py_NE));<span class='error_goto'> if (unlikely(__pyx_t_9 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_3 = (__pyx_t_9 != 0);
    __pyx_t_4 = __pyx_t_3;
    __pyx_L19_bool_binop_done:;
    if (__pyx_t_4) {
</pre><pre class='cython line score-55' onclick='toggleDiv(this)'>+253:             <span class="k">raise</span> <span class="n">PyteomicsError</span><span class="p">(</span><span class="s">&#39;Unknown label: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nterm</span><span class="p">))</span></pre>
<pre class='cython code score-55'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_PyteomicsError);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Unknown_label, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_6 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
        }
      }
      if (!__pyx_t_6) {
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_v_nterm);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      } else {
        __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nterm);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+1, __pyx_v_nterm);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nterm);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_7) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else {
        __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_7); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); __pyx_t_7 = NULL;
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+1, __pyx_t_2);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
        __pyx_t_2 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+254:         <span class="k">if</span> <span class="n">cterm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">cterm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">slabels</span><span class="p">:</span></pre>
<pre class='cython code score-2'>    __pyx_t_3 = (__pyx_v_cterm != ((PyObject*)Py_None));
    __pyx_t_9 = (__pyx_t_3 != 0);
    if (__pyx_t_9) {
    } else {
      __pyx_t_4 = __pyx_t_9;
      goto __pyx_L22_bool_binop_done;
    }
    __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_v_cterm, __pyx_v_slabels, Py_NE));<span class='error_goto'> if (unlikely(__pyx_t_9 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_3 = (__pyx_t_9 != 0);
    __pyx_t_4 = __pyx_t_3;
    __pyx_L22_bool_binop_done:;
    if (__pyx_t_4) {
</pre><pre class='cython line score-55' onclick='toggleDiv(this)'>+255:             <span class="k">raise</span> <span class="n">PyteomicsError</span><span class="p">(</span><span class="s">&#39;Unknown label: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cterm</span><span class="p">))</span></pre>
<pre class='cython code score-55'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_PyteomicsError);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Unknown_label, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        }
      }
      if (!__pyx_t_7) {
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_cterm);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      } else {
        __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_7); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); __pyx_t_7 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cterm);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_v_cterm);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cterm);
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      if (!__pyx_t_2) {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else {
        __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_12);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
        __pyx_t_12 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    goto __pyx_L17;
  }
  __pyx_L17:;
</pre><pre class='cython line score-0'>&#xA0;256: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+257:     <span class="k">if</span> <span class="n">split</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_split != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+258:         <span class="n">i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>    __pyx_v_i = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+259:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">PyList_Size</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">)):</span></pre>
<pre class='cython code score-5'>    __pyx_t_10 = <span class='py_c_api'>PyList_Size</span>(__pyx_v_parsed_sequence);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_10; __pyx_t_13+=1) {
      __pyx_v_i = __pyx_t_13;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+260:             <span class="n">tgroup</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">tuple</span><span class="p">&gt;</span><span class="n">PyList_GET_ITEM</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-3'>      __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parsed_sequence, __pyx_v_i);
      __pyx_t_5 = ((PyObject *)__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_tgroup, ((PyObject*)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+261:             <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tgroup</span><span class="p">)</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-6'>      if (unlikely(__pyx_v_tgroup == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_14 = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_v_tgroup);<span class='error_goto'> if (unlikely(__pyx_t_14 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_4 = ((__pyx_t_14 == 2) != 0);
      if (__pyx_t_4) {
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+262:                 <span class="n">mod</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">str</span><span class="p">&gt;</span><span class="n">PyTuple_GET_ITEM</span><span class="p">(</span><span class="n">tgroup</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-3'>        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_v_tgroup, 0);
        __pyx_t_5 = ((PyObject *)__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_mod, ((PyObject*)__pyx_t_5));
        __pyx_t_5 = 0;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+263:                 <span class="n">X</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">str</span><span class="p">&gt;</span><span class="n">PyTuple_GET_ITEM</span><span class="p">(</span><span class="n">tgroup</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-3'>        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_v_tgroup, 1);
        __pyx_t_5 = ((PyObject *)__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_X, ((PyObject*)__pyx_t_5));
        __pyx_t_5 = 0;
        goto __pyx_L27;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;264:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+265:                 <span class="n">mod</span> <span class="o">=</span> <span class="s">&#39;&#39;</span></pre>
<pre class='cython code score-2'>        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s__5);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_mod, __pyx_kp_s__5);
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+266:                 <span class="n">X</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">str</span><span class="p">&gt;</span><span class="n">PyTuple_GET_ITEM</span><span class="p">(</span><span class="n">tgroup</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-3'>        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_v_tgroup, 0);
        __pyx_t_5 = ((PyObject *)__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_X, ((PyObject*)__pyx_t_5));
        __pyx_t_5 = 0;
      }
      __pyx_L27:;
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+267:             <span class="k">if</span> <span class="p">((</span><span class="ow">not</span> <span class="n">mod</span><span class="p">)</span> <span class="ow">and</span> <span class="n">X</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">slabels</span><span class="p">)</span> <span class="ow">or</span>\</pre>
<pre class='cython code score-4'>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_mod);<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_9 = ((!__pyx_t_3) != 0);
      if (!__pyx_t_9) {
        goto __pyx_L30_next_or;
      } else {
      }
      __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_v_X, __pyx_v_slabels, Py_NE));<span class='error_goto'> if (unlikely(__pyx_t_9 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_3 = (__pyx_t_9 != 0);
      if (!__pyx_t_3) {
      } else {
        __pyx_t_4 = __pyx_t_3;
        goto __pyx_L29_bool_binop_done;
      }
      __pyx_L30_next_or:;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+268:                 <span class="ow">not</span> <span class="p">((</span><span class="n">mod</span><span class="o">+</span><span class="n">X</span> <span class="ow">in</span> <span class="n">slabels</span><span class="p">)</span> <span class="ow">or</span>\</pre>
<pre class='cython code score-8'>      __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_mod, __pyx_v_X);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_t_5, __pyx_v_slabels, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_9 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_15 = (__pyx_t_9 != 0);
      if (!__pyx_t_15) {
      } else {
        __pyx_t_3 = __pyx_t_15;
        goto __pyx_L32_bool_binop_done;
      }
/* … */
      __pyx_t_15 = ((!__pyx_t_3) != 0);
      __pyx_t_4 = __pyx_t_15;
      __pyx_L29_bool_binop_done:;
      if (__pyx_t_4) {
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+269:                 <span class="p">(</span><span class="n">X</span> <span class="ow">in</span> <span class="n">slabels</span> <span class="ow">and</span> <span class="p">(</span><span class="n">mod</span> <span class="ow">in</span> <span class="n">slabels</span> <span class="ow">or</span> <span class="n">allow_unknown_modifications</span><span class="p">))):</span></pre>
<pre class='cython code score-4'>      __pyx_t_15 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_v_X, __pyx_v_slabels, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_15 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_9 = (__pyx_t_15 != 0);
      if (__pyx_t_9) {
      } else {
        __pyx_t_3 = __pyx_t_9;
        goto __pyx_L32_bool_binop_done;
      }
      __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_v_mod, __pyx_v_slabels, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_9 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_15 = (__pyx_t_9 != 0);
      if (!__pyx_t_15) {
      } else {
        __pyx_t_3 = __pyx_t_15;
        goto __pyx_L32_bool_binop_done;
      }
      __pyx_t_15 = (__pyx_v_allow_unknown_modifications != 0);
      __pyx_t_3 = __pyx_t_15;
      __pyx_L32_bool_binop_done:;
</pre><pre class='cython line score-55' onclick='toggleDiv(this)'>+270:                 <span class="k">raise</span> <span class="n">PyteomicsError</span><span class="p">(</span><span class="s">&#39;Unknown label: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tgroup</span><span class="p">))</span></pre>
<pre class='cython code score-55'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_PyteomicsError);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Unknown_label, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        __pyx_t_2 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
          __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
          if (likely(__pyx_t_2)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
          }
        }
        if (!__pyx_t_2) {
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, __pyx_v_tgroup);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        } else {
          __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); __pyx_t_2 = NULL;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tgroup);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_v_tgroup);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tgroup);
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
          __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
          if (likely(__pyx_t_12)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          }
        }
        if (!__pyx_t_12) {
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        } else {
          __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_12); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); __pyx_t_12 = NULL;
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_t_6);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
          __pyx_t_6 = 0;
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
    goto __pyx_L24;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;271: </pre>
<pre class='cython line score-0'>&#xA0;272:     <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+273:         <span class="n">i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>    __pyx_v_i = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+274:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">PyList_Size</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">)):</span></pre>
<pre class='cython code score-5'>    __pyx_t_10 = <span class='py_c_api'>PyList_Size</span>(__pyx_v_parsed_sequence);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_10; __pyx_t_13+=1) {
      __pyx_v_i = __pyx_t_13;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+275:             <span class="n">sgroup</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">str</span><span class="p">&gt;</span><span class="n">PyList_GET_ITEM</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-3'>      __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parsed_sequence, __pyx_v_i);
      __pyx_t_5 = ((PyObject *)__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sgroup, ((PyObject*)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='cython line score-0'>&#xA0;276: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+277:             <span class="n">match</span> <span class="o">=</span> <span class="n">PyObject_CallMethodObjArgs</span><span class="p">(</span><span class="n">_modX_split</span><span class="p">,</span> <span class="s">&quot;match&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">PyObject</span><span class="o">*&gt;</span><span class="n">sgroup</span><span class="p">,</span> <span class="bp">NULL</span><span class="p">)</span></pre>
<pre class='cython code score-8'>      __pyx_t_5 = __pyx_v_9pyteomics_7cparser__modX_split;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      __pyx_t_1 = <span class='py_c_api'>PyObject_CallMethodObjArgs</span>(__pyx_t_5, __pyx_n_s_match, ((PyObject *)__pyx_v_sgroup), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_match, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+278:             <span class="n">temp</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">tuple</span><span class="p">&gt;</span><span class="n">PyObject_CallMethodObjArgs</span><span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="s">&quot;groups&quot;</span><span class="p">,</span> <span class="bp">NULL</span><span class="p">)</span></pre>
<pre class='cython code score-8'>      __pyx_t_1 = <span class='py_c_api'>PyObject_CallMethodObjArgs</span>(__pyx_v_match, __pyx_n_s_groups, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = __pyx_t_1;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_temp, ((PyObject*)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+279:             <span class="n">mod</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">str</span><span class="p">&gt;</span><span class="n">PyTuple_GET_ITEM</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-3'>      __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_v_temp, 0);
      __pyx_t_5 = ((PyObject *)__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_mod, ((PyObject*)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+280:             <span class="n">X</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">str</span><span class="p">&gt;</span><span class="n">PyTuple_GET_ITEM</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-3'>      __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_v_temp, 1);
      __pyx_t_5 = ((PyObject *)__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_X, ((PyObject*)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+281:             <span class="n">is_mod</span> <span class="o">=</span> <span class="n">PyObject_IsTrue</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span></pre>
<pre class='cython code score-5'>      __pyx_t_4 = <span class='py_c_api'>PyObject_IsTrue</span>(__pyx_v_mod);<span class='error_goto'> if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_v_is_mod = __pyx_t_4;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+282:             <span class="n">in_labels</span> <span class="o">=</span> <span class="n">X</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">slabels</span></pre>
<pre class='cython code score-2'>      __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_v_X, __pyx_v_slabels, Py_NE));<span class='error_goto'> if (unlikely(__pyx_t_4 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_v_in_labels = __pyx_t_4;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+283:             <span class="k">if</span> <span class="p">((</span><span class="ow">not</span> <span class="n">is_mod</span><span class="p">)</span> <span class="ow">and</span> <span class="n">in_labels</span><span class="p">)</span> <span class="ow">or</span>\</pre>
<pre class='cython code score-0'>      __pyx_t_15 = ((!(__pyx_v_is_mod != 0)) != 0);
      if (!__pyx_t_15) {
        goto __pyx_L40_next_or;
      } else {
      }
      __pyx_t_15 = (__pyx_v_in_labels != 0);
      if (!__pyx_t_15) {
      } else {
        __pyx_t_4 = __pyx_t_15;
        goto __pyx_L39_bool_binop_done;
      }
      __pyx_L40_next_or:;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+284:                 <span class="ow">not</span> <span class="p">((</span><span class="n">mod</span><span class="o">+</span><span class="n">X</span> <span class="ow">in</span> <span class="n">slabels</span><span class="p">)</span> <span class="ow">or</span>\</pre>
<pre class='cython code score-8'>      __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_mod, __pyx_v_X);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_t_5, __pyx_v_slabels, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_9 = (__pyx_t_3 != 0);
      if (!__pyx_t_9) {
      } else {
        __pyx_t_15 = __pyx_t_9;
        goto __pyx_L42_bool_binop_done;
      }
/* … */
      __pyx_t_9 = ((!__pyx_t_15) != 0);
      __pyx_t_4 = __pyx_t_9;
      __pyx_L39_bool_binop_done:;
      if (__pyx_t_4) {
</pre><pre class='cython line score-4' onclick='toggleDiv(this)'>+285:                 <span class="p">(</span><span class="n">X</span> <span class="ow">in</span> <span class="n">slabels</span> <span class="ow">and</span> <span class="p">(</span><span class="n">mod</span> <span class="ow">in</span> <span class="n">slabels</span> <span class="ow">or</span> <span class="n">allow_unknown_modifications</span><span class="p">))):</span></pre>
<pre class='cython code score-4'>      __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_v_X, __pyx_v_slabels, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_9 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_3 = (__pyx_t_9 != 0);
      if (__pyx_t_3) {
      } else {
        __pyx_t_15 = __pyx_t_3;
        goto __pyx_L42_bool_binop_done;
      }
      __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_v_mod, __pyx_v_slabels, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_9 = (__pyx_t_3 != 0);
      if (!__pyx_t_9) {
      } else {
        __pyx_t_15 = __pyx_t_9;
        goto __pyx_L42_bool_binop_done;
      }
      __pyx_t_9 = (__pyx_v_allow_unknown_modifications != 0);
      __pyx_t_15 = __pyx_t_9;
      __pyx_L42_bool_binop_done:;
</pre><pre class='cython line score-55' onclick='toggleDiv(this)'>+286:                 <span class="k">raise</span> <span class="n">PyteomicsError</span><span class="p">(</span><span class="s">&#39;Unknown label: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sgroup</span><span class="p">))</span></pre>
<pre class='cython code score-55'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_PyteomicsError);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Unknown_label, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_12 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
          __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
          if (likely(__pyx_t_12)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          }
        }
        if (!__pyx_t_12) {
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_v_sgroup);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        } else {
          __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_12); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); __pyx_t_12 = NULL;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sgroup);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_v_sgroup);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sgroup);
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = NULL;
        if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
          __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
          if (likely(__pyx_t_6)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          }
        }
        if (!__pyx_t_6) {
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        } else {
          __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_6); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); __pyx_t_6 = NULL;
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+1, __pyx_t_7);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
          __pyx_t_7 = 0;
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
    }
  }
  __pyx_L24:;
</pre><pre class='cython line score-0'>&#xA0;287: </pre>
<pre class='cython line score-0'>&#xA0;288:     <span class="c"># Append terminal labels</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+289:     <span class="k">if</span> <span class="n">show_unmodified_termini</span> <span class="ow">or</span> <span class="n">nterm</span> <span class="o">!=</span> <span class="n">std_nterm</span><span class="p">:</span></pre>
<pre class='cython code score-2'>  __pyx_t_9 = (__pyx_v_show_unmodified_termini != 0);
  if (!__pyx_t_9) {
  } else {
    __pyx_t_4 = __pyx_t_9;
    goto __pyx_L47_bool_binop_done;
  }
  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_nterm, __pyx_v_9pyteomics_7cparser_std_nterm, Py_NE));<span class='error_goto'> if (unlikely(__pyx_t_9 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_15 = (__pyx_t_9 != 0);
  __pyx_t_4 = __pyx_t_15;
  __pyx_L47_bool_binop_done:;
  if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+290:         <span class="k">if</span> <span class="n">split</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = (__pyx_v_split != 0);
    if (__pyx_t_4) {
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+291:             <span class="n">temp</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">tuple</span><span class="p">&gt;</span><span class="n">PyList_GET_ITEM</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-3'>      __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parsed_sequence, 0);
      __pyx_t_5 = ((PyObject *)__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_temp, ((PyObject*)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+292:             <span class="n">temp</span> <span class="o">=</span> <span class="p">(&lt;</span><span class="kt">str</span><span class="p">&gt;</span><span class="n">nterm</span><span class="p">,</span> <span class="p">)</span> <span class="o">+</span> <span class="n">temp</span></pre>
<pre class='cython code score-14'>      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_v_nterm));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_nterm);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nterm);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_v_temp);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_temp, ((PyObject*)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+293:             <span class="n">Py_INCREF</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      Py_INCREF(__pyx_v_temp);
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+294:             <span class="n">PyList_SET_ITEM</span><span class="p">(&lt;</span><span class="kt">list</span><span class="p">&gt;</span><span class="n">parsed_sequence</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span></pre>
<pre class='cython code score-1'>      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_v_parsed_sequence, 0, __pyx_v_temp);
      goto __pyx_L49;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;295:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+296:             <span class="n">PyList_Insert</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">nterm</span><span class="p">)</span></pre>
<pre class='cython code score-5'>      __pyx_t_16 = <span class='py_c_api'>PyList_Insert</span>(__pyx_v_parsed_sequence, 0, __pyx_v_nterm);<span class='error_goto'> if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_L49:;
    goto __pyx_L46;
  }
  __pyx_L46:;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+297:     <span class="k">if</span> <span class="n">show_unmodified_termini</span> <span class="ow">or</span> <span class="n">cterm</span> <span class="o">!=</span> <span class="n">std_cterm</span><span class="p">:</span></pre>
<pre class='cython code score-2'>  __pyx_t_15 = (__pyx_v_show_unmodified_termini != 0);
  if (!__pyx_t_15) {
  } else {
    __pyx_t_4 = __pyx_t_15;
    goto __pyx_L51_bool_binop_done;
  }
  __pyx_t_15 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_cterm, __pyx_v_9pyteomics_7cparser_std_cterm, Py_NE));<span class='error_goto'> if (unlikely(__pyx_t_15 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 297; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_9 = (__pyx_t_15 != 0);
  __pyx_t_4 = __pyx_t_9;
  __pyx_L51_bool_binop_done:;
  if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+298:         <span class="k">if</span> <span class="n">split</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = (__pyx_v_split != 0);
    if (__pyx_t_4) {
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+299:             <span class="n">temp</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">tuple</span><span class="p">&gt;</span><span class="n">PyList_GET_ITEM</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-9'>      if (unlikely(__pyx_v_parsed_sequence == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_10 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_parsed_sequence);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 299; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parsed_sequence, (__pyx_t_10 - 1));
      __pyx_t_1 = ((PyObject *)__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_temp, ((PyObject*)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+300:             <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span> <span class="o">+</span> <span class="p">(</span><span class="n">cterm</span><span class="p">,)</span></pre>
<pre class='cython code score-14'>      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cterm);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_cterm);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cterm);
      __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_temp, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_temp, ((PyObject*)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+301:             <span class="n">Py_INCREF</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      Py_INCREF(__pyx_v_temp);
</pre><pre class='cython line score-7' onclick='toggleDiv(this)'>+302:             <span class="n">PyList_SET_ITEM</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span></pre>
<pre class='cython code score-7'>      if (unlikely(__pyx_v_parsed_sequence == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_10 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_parsed_sequence);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_v_parsed_sequence, (__pyx_t_10 - 1), __pyx_v_temp);
      goto __pyx_L53;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;303:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+304:             <span class="n">PyList_Append</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">,</span> <span class="n">cterm</span><span class="p">)</span></pre>
<pre class='cython code score-5'>      __pyx_t_16 = <span class='py_c_api'>PyList_Append</span>(__pyx_v_parsed_sequence, __pyx_v_cterm);<span class='error_goto'> if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_L53:;
    goto __pyx_L50;
  }
  __pyx_L50:;
</pre><pre class='cython line score-0'>&#xA0;305: </pre>
<pre class='cython line score-0'>&#xA0;306: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+307:     <span class="k">return</span> <span class="n">parsed_sequence</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_parsed_sequence);
  __pyx_r = __pyx_v_parsed_sequence;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;308: </pre>
<pre class='cython line score-0'>&#xA0;309: </pre>
<pre class='cython line score-49' onclick='toggleDiv(this)'>+310: <span class="k">def</span> <span class="nf">tostring</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">,</span> <span class="n">show_unmodified_termini</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span></pre>
<pre class='cython code score-49'>/* Python wrapper */
static PyObject *__pyx_pw_9pyteomics_7cparser_9tostring(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_9pyteomics_7cparser_8tostring[] = "Create a string from a parsed sequence.\n\n    Parameters\n    ----------\n    parsed_sequence : iterable\n        Expected to be in one of the formats returned by\n        :py:func:`parse`, i.e. list of labels or list of tuples.\n    show_unmodified_termini : bool, optional\n        Defines the behavior towards standard terminal groups in the input.\n        :py:const:`True` means that they will be preserved if present (default).\n        :py:const:`False` means that they will be removed. Standard terminal\n        groups will not be added if not shown in `parsed_sequence`,\n        regardless of this setting.\n\n    Returns\n    -------\n    sequence : str\n    ";
static PyMethodDef __pyx_mdef_9pyteomics_7cparser_9tostring = {"tostring", (PyCFunction)__pyx_pw_9pyteomics_7cparser_9tostring, METH_VARARGS|METH_KEYWORDS, __pyx_doc_9pyteomics_7cparser_8tostring};
static PyObject *__pyx_pw_9pyteomics_7cparser_9tostring(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_parsed_sequence = 0;
  PyObject *__pyx_v_show_unmodified_termini = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("tostring (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_parsed_sequence,&amp;__pyx_n_s_show_unmodified_termini,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)Py_True);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_parsed_sequence)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_show_unmodified_termini);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "tostring") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_parsed_sequence = values[0];
    __pyx_v_show_unmodified_termini = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("tostring", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser.tostring", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9pyteomics_7cparser_8tostring(__pyx_self, __pyx_v_parsed_sequence, __pyx_v_show_unmodified_termini);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9pyteomics_7cparser_8tostring(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_parsed_sequence, PyObject *__pyx_v_show_unmodified_termini) {
  PyObject *__pyx_v_labels = NULL;
  PyObject *__pyx_v_group = NULL;
  PyObject *__pyx_v_group_l = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("tostring", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser.tostring", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_labels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_group);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_group_l);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_parsed_sequence, __pyx_n_s_show_unmodified_termini, __pyx_n_s_labels, __pyx_n_s_group, __pyx_n_s_group_l);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_9pyteomics_7cparser_9tostring, NULL, __pyx_n_s_pyteomics_cparser);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_tostring, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;311:     <span class="sd">&quot;&quot;&quot;Create a string from a parsed sequence.</span></pre>
<pre class='cython line score-0'>&#xA0;312: </pre>
<pre class='cython line score-0'>&#xA0;313: <span class="sd">    Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;314: <span class="sd">    ----------</span></pre>
<pre class='cython line score-0'>&#xA0;315: <span class="sd">    parsed_sequence : iterable</span></pre>
<pre class='cython line score-0'>&#xA0;316: <span class="sd">        Expected to be in one of the formats returned by</span></pre>
<pre class='cython line score-0'>&#xA0;317: <span class="sd">        :py:func:`parse`, i.e. list of labels or list of tuples.</span></pre>
<pre class='cython line score-0'>&#xA0;318: <span class="sd">    show_unmodified_termini : bool, optional</span></pre>
<pre class='cython line score-0'>&#xA0;319: <span class="sd">        Defines the behavior towards standard terminal groups in the input.</span></pre>
<pre class='cython line score-0'>&#xA0;320: <span class="sd">        :py:const:`True` means that they will be preserved if present (default).</span></pre>
<pre class='cython line score-0'>&#xA0;321: <span class="sd">        :py:const:`False` means that they will be removed. Standard terminal</span></pre>
<pre class='cython line score-0'>&#xA0;322: <span class="sd">        groups will not be added if not shown in `parsed_sequence`,</span></pre>
<pre class='cython line score-0'>&#xA0;323: <span class="sd">        regardless of this setting.</span></pre>
<pre class='cython line score-0'>&#xA0;324: </pre>
<pre class='cython line score-0'>&#xA0;325: <span class="sd">    Returns</span></pre>
<pre class='cython line score-0'>&#xA0;326: <span class="sd">    -------</span></pre>
<pre class='cython line score-0'>&#xA0;327: <span class="sd">    sequence : str</span></pre>
<pre class='cython line score-0'>&#xA0;328: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+329:     <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_labels = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-46' onclick='toggleDiv(this)'>+330:     <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">parsed_sequence</span><span class="p">:</span></pre>
<pre class='cython code score-46'>  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_parsed_sequence)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_parsed_sequence)) {
    __pyx_t_1 = __pyx_v_parsed_sequence; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_parsed_sequence);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      } else {
        if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_group, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+331:         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span></pre>
<pre class='cython code score-5'>    __pyx_t_5 = <span class='py_c_api'>PyString_Check</span>(__pyx_v_group); 
    __pyx_t_6 = (__pyx_t_5 != 0);
    if (__pyx_t_6) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+332:             <span class="k">if</span> <span class="p">(</span><span class="n">group</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">std_cterm</span><span class="p">,</span> <span class="n">std_nterm</span><span class="p">))</span> <span class="ow">or</span> <span class="n">show_unmodified_termini</span><span class="p">:</span></pre>
<pre class='cython code score-8'>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_group);
      __pyx_t_4 = __pyx_v_group;
      __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_t_4, __pyx_v_9pyteomics_7cparser_std_cterm, Py_NE));<span class='error_goto'> if (unlikely(__pyx_t_7 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      if (__pyx_t_7) {
      } else {
        __pyx_t_5 = __pyx_t_7;
        goto __pyx_L9_bool_binop_done;
      }
      __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_t_4, __pyx_v_9pyteomics_7cparser_std_nterm, Py_NE));<span class='error_goto'> if (unlikely(__pyx_t_7 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_5 = __pyx_t_7;
      __pyx_L9_bool_binop_done:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_7 = (__pyx_t_5 != 0);
      if (!__pyx_t_7) {
      } else {
        __pyx_t_6 = __pyx_t_7;
        goto __pyx_L7_bool_binop_done;
      }
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_show_unmodified_termini);<span class='error_goto'> if (unlikely(__pyx_t_7 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_6 = __pyx_t_7;
      __pyx_L7_bool_binop_done:;
      if (__pyx_t_6) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+333:                 <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span></pre>
<pre class='cython code score-2'>        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_labels, __pyx_v_group);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        goto __pyx_L6;
      }
      __pyx_L6:;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;334:         <span class="k">else</span><span class="p">:</span> <span class="c"># treat `group` as a tuple</span></pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+335:             <span class="n">group_l</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">group</span><span class="p">)</span></pre>
<pre class='cython code score-6'>      __pyx_t_4 = <span class='py_c_api'>PySequence_List</span>(__pyx_v_group);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_group_l, ((PyObject*)__pyx_t_4));
      __pyx_t_4 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+336:             <span class="k">if</span> <span class="ow">not</span> <span class="n">show_unmodified_termini</span><span class="p">:</span></pre>
<pre class='cython code score-2'>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_show_unmodified_termini);<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_7 = ((!__pyx_t_6) != 0);
      if (__pyx_t_7) {
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+337:                 <span class="k">if</span> <span class="n">std_cterm</span> <span class="ow">in</span> <span class="n">group_l</span><span class="p">:</span> <span class="n">group_l</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">std_cterm</span><span class="p">)</span></pre>
<pre class='cython code score-29'>        __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_v_9pyteomics_7cparser_std_cterm, __pyx_v_group_l, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_7 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_6 = (__pyx_t_7 != 0);
        if (__pyx_t_6) {
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_group_l, __pyx_n_s_remove);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_10 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
            __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
            if (likely(__pyx_t_10)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
            }
          }
          if (!__pyx_t_10) {
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_9pyteomics_7cparser_std_cterm);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          } else {
            __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_10); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); __pyx_t_10 = NULL;
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_cterm);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, __pyx_v_9pyteomics_7cparser_std_cterm);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_9pyteomics_7cparser_std_cterm);
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          goto __pyx_L12;
        }
        __pyx_L12:;
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+338:                 <span class="k">if</span> <span class="n">std_nterm</span> <span class="ow">in</span> <span class="n">group_l</span><span class="p">:</span> <span class="n">group_l</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">std_nterm</span><span class="p">)</span></pre>
<pre class='cython code score-29'>        __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PySequence_Contains</span>(__pyx_v_9pyteomics_7cparser_std_nterm, __pyx_v_group_l, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_6 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_7 = (__pyx_t_6 != 0);
        if (__pyx_t_7) {
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_group_l, __pyx_n_s_remove);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_11 = NULL;
          if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
            __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
            if (likely(__pyx_t_11)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
            }
          }
          if (!__pyx_t_11) {
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_v_9pyteomics_7cparser_std_nterm);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          } else {
            __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_11); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); __pyx_t_11 = NULL;
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_nterm);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+1, __pyx_v_9pyteomics_7cparser_std_nterm);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_9pyteomics_7cparser_std_nterm);
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          goto __pyx_L13;
        }
        __pyx_L13:;
        goto __pyx_L11;
      }
      __pyx_L11:;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+339:             <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">group_l</span><span class="p">))</span></pre>
<pre class='cython code score-5'>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyString_Join</span>(__pyx_kp_s__5, __pyx_v_group_l);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_labels, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_8 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_L5:;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+340:     <span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyString_Join</span>(__pyx_kp_s__5, __pyx_v_labels);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;341: </pre>
<pre class='cython line score-0'>&#xA0;342: </pre>
<pre class='cython line score-71' onclick='toggleDiv(this)'>+343: <span class="k">cpdef</span> <span class="kt">dict</span> <span class="nf">amino_acid_composition</span><span class="p">(</span><span class="nb">object</span> <span class="n">sequence</span><span class="p">,</span> <span class="nb">int</span> <span class="n">show_unmodified_termini</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="nb">int</span> <span class="n">term_aa</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span></pre>
<pre class='cython code score-71'>static PyObject *__pyx_pw_9pyteomics_7cparser_11amino_acid_composition(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_9pyteomics_7cparser_amino_acid_composition(PyObject *__pyx_v_sequence, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_9pyteomics_7cparser_amino_acid_composition *__pyx_optional_args) {
  int __pyx_v_show_unmodified_termini = ((int)0);
  int __pyx_v_term_aa = ((int)0);
  int __pyx_v_allow_unknown_modifications = ((int)0);
  PyObject *__pyx_v_labels = __pyx_k__6;
  PyObject *__pyx_v_parsed_sequence = 0;
  int __pyx_v_nterm_aa_position;
  int __pyx_v_cterm_aa_position;
  int __pyx_v_aa_count;
  PyObject *__pyx_v_aa_dict = 0;
  PyObject *__pyx_v_aa = 0;
  PyObject *__pyx_v__labels = 0;
  PyObject *__pyx_v_temp = 0;
  PyObject *__pyx_v_pvalue;
  Py_ssize_t __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("amino_acid_composition", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_show_unmodified_termini = __pyx_optional_args-&gt;show_unmodified_termini;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_term_aa = __pyx_optional_args-&gt;term_aa;
        if (__pyx_optional_args-&gt;__pyx_n &gt; 2) {
          __pyx_v_allow_unknown_modifications = __pyx_optional_args-&gt;allow_unknown_modifications;
          if (__pyx_optional_args-&gt;__pyx_n &gt; 3) {
            __pyx_v_labels = __pyx_optional_args-&gt;labels;
          }
        }
      }
    }
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser.amino_acid_composition", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_parsed_sequence);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_aa_dict);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_aa);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__labels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_temp);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_9pyteomics_7cparser_11amino_acid_composition(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_9pyteomics_7cparser_10amino_acid_composition[] = "Calculate amino acid composition of a polypeptide.\n\n    Parameters\n    ----------\n    sequence : str or list\n        The sequence of a polypeptide or a list with a parsed sequence.\n    show_unmodified_termini : bool, optional\n        If :py:const:`True` then the unmodified N- and C-terminus are explicitly\n        shown in the returned dict. Default value is :py:const:`False`.\n    term_aa : bool, optional\n        If :py:const:`True` then the terminal amino acid residues are\n        artificially modified with `nterm` or `cterm` modification.\n        Default value is :py:const:`False`.\n    allow_unknown_modifications : bool, optional\n        If :py:const:`True` then do not raise an exception when an unknown\n        modification of a known amino acid residue is found in the sequence.\n        Default value is :py:const:`False`.\n    labels : list, optional\n        A list of allowed labels for amino acids and terminal modifications.\n\n    Returns\n    -------\n    out : dict\n        A dictionary of amino acid composition.\n\n    Examples\n    --------\n    &gt;&gt;&gt; amino_acid_composition('PEPTIDE') ==     {'I': 1, 'P': 2, 'E': 2, 'T': 1, 'D': 1}\n    True\n    &gt;&gt;&gt; amino_acid_composition('PEPTDE', term_aa=True) ==     {'ctermE': 1, 'E': 1, 'D': 1, 'P': 1, 'T': 1, 'ntermP': 1}\n    True\n    &gt;&gt;&gt; amino_acid_composition('PEPpTIDE', labels=std_labels+['pT']) ==     {'I': 1, 'P': 2, 'E': 2, 'D': 1, 'pT': 1}\n    True\n    ";
static PyObject *__pyx_pw_9pyteomics_7cparser_11amino_acid_composition(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_sequence = 0;
  int __pyx_v_show_unmodified_termini;
  int __pyx_v_term_aa;
  int __pyx_v_allow_unknown_modifications;
  PyObject *__pyx_v_labels = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("amino_acid_composition (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_sequence,&amp;__pyx_n_s_show_unmodified_termini,&amp;__pyx_n_s_term_aa,&amp;__pyx_n_s_allow_unknown_modifications,&amp;__pyx_n_s_labels,0};
    PyObject* values[5] = {0,0,0,0,0};
    values[4] = __pyx_k__6;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sequence)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_show_unmodified_termini);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_term_aa);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_allow_unknown_modifications);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_labels);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "amino_acid_composition") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_sequence = values[0];
    if (values[1]) {
      __pyx_v_show_unmodified_termini = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_show_unmodified_termini == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_show_unmodified_termini = ((int)0);
    }
    if (values[2]) {
      __pyx_v_term_aa = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_term_aa == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_term_aa = ((int)0);
    }
    if (values[3]) {
      __pyx_v_allow_unknown_modifications = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]);<span class='error_goto'> if (unlikely((__pyx_v_allow_unknown_modifications == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_allow_unknown_modifications = ((int)0);
    }
    __pyx_v_labels = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("amino_acid_composition", 0, 1, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser.amino_acid_composition", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9pyteomics_7cparser_10amino_acid_composition(__pyx_self, __pyx_v_sequence, __pyx_v_show_unmodified_termini, __pyx_v_term_aa, __pyx_v_allow_unknown_modifications, __pyx_v_labels);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9pyteomics_7cparser_10amino_acid_composition(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_sequence, int __pyx_v_show_unmodified_termini, int __pyx_v_term_aa, int __pyx_v_allow_unknown_modifications, PyObject *__pyx_v_labels) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("amino_acid_composition", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 4;
  __pyx_t_2.show_unmodified_termini = __pyx_v_show_unmodified_termini;
  __pyx_t_2.term_aa = __pyx_v_term_aa;
  __pyx_t_2.allow_unknown_modifications = __pyx_v_allow_unknown_modifications;
  __pyx_t_2.labels = __pyx_v_labels;
  __pyx_t_1 = __pyx_f_9pyteomics_7cparser_amino_acid_composition(__pyx_v_sequence, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("pyteomics.cparser.amino_acid_composition", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+344:                                   <span class="nb">int</span> <span class="n">allow_unknown_modifications</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="nb">object</span> <span class="n">labels</span><span class="o">=</span><span class="n">std_labels</span><span class="p">):</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_labels);
  __pyx_k__6 = __pyx_v_9pyteomics_7cparser_std_labels;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_9pyteomics_7cparser_std_labels);
/* … */
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_9pyteomics_7cparser_std_labels);
  __pyx_k__6 = __pyx_v_9pyteomics_7cparser_std_labels;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_9pyteomics_7cparser_std_labels);
</pre><pre class='cython line score-0'>&#xA0;345:     <span class="sd">&quot;&quot;&quot;Calculate amino acid composition of a polypeptide.</span></pre>
<pre class='cython line score-0'>&#xA0;346: </pre>
<pre class='cython line score-0'>&#xA0;347: <span class="sd">    Parameters</span></pre>
<pre class='cython line score-0'>&#xA0;348: <span class="sd">    ----------</span></pre>
<pre class='cython line score-0'>&#xA0;349: <span class="sd">    sequence : str or list</span></pre>
<pre class='cython line score-0'>&#xA0;350: <span class="sd">        The sequence of a polypeptide or a list with a parsed sequence.</span></pre>
<pre class='cython line score-0'>&#xA0;351: <span class="sd">    show_unmodified_termini : bool, optional</span></pre>
<pre class='cython line score-0'>&#xA0;352: <span class="sd">        If :py:const:`True` then the unmodified N- and C-terminus are explicitly</span></pre>
<pre class='cython line score-0'>&#xA0;353: <span class="sd">        shown in the returned dict. Default value is :py:const:`False`.</span></pre>
<pre class='cython line score-0'>&#xA0;354: <span class="sd">    term_aa : bool, optional</span></pre>
<pre class='cython line score-0'>&#xA0;355: <span class="sd">        If :py:const:`True` then the terminal amino acid residues are</span></pre>
<pre class='cython line score-0'>&#xA0;356: <span class="sd">        artificially modified with `nterm` or `cterm` modification.</span></pre>
<pre class='cython line score-0'>&#xA0;357: <span class="sd">        Default value is :py:const:`False`.</span></pre>
<pre class='cython line score-0'>&#xA0;358: <span class="sd">    allow_unknown_modifications : bool, optional</span></pre>
<pre class='cython line score-0'>&#xA0;359: <span class="sd">        If :py:const:`True` then do not raise an exception when an unknown</span></pre>
<pre class='cython line score-0'>&#xA0;360: <span class="sd">        modification of a known amino acid residue is found in the sequence.</span></pre>
<pre class='cython line score-0'>&#xA0;361: <span class="sd">        Default value is :py:const:`False`.</span></pre>
<pre class='cython line score-0'>&#xA0;362: <span class="sd">    labels : list, optional</span></pre>
<pre class='cython line score-0'>&#xA0;363: <span class="sd">        A list of allowed labels for amino acids and terminal modifications.</span></pre>
<pre class='cython line score-0'>&#xA0;364: </pre>
<pre class='cython line score-0'>&#xA0;365: <span class="sd">    Returns</span></pre>
<pre class='cython line score-0'>&#xA0;366: <span class="sd">    -------</span></pre>
<pre class='cython line score-0'>&#xA0;367: <span class="sd">    out : dict</span></pre>
<pre class='cython line score-0'>&#xA0;368: <span class="sd">        A dictionary of amino acid composition.</span></pre>
<pre class='cython line score-0'>&#xA0;369: </pre>
<pre class='cython line score-0'>&#xA0;370: <span class="sd">    Examples</span></pre>
<pre class='cython line score-0'>&#xA0;371: <span class="sd">    --------</span></pre>
<pre class='cython line score-0'>&#xA0;372: <span class="sd">    &gt;&gt;&gt; amino_acid_composition(&#39;PEPTIDE&#39;) == \</span></pre>
<pre class='cython line score-0'>&#xA0;373: <span class="sd">    {&#39;I&#39;: 1, &#39;P&#39;: 2, &#39;E&#39;: 2, &#39;T&#39;: 1, &#39;D&#39;: 1}</span></pre>
<pre class='cython line score-0'>&#xA0;374: <span class="sd">    True</span></pre>
<pre class='cython line score-0'>&#xA0;375: <span class="sd">    &gt;&gt;&gt; amino_acid_composition(&#39;PEPTDE&#39;, term_aa=True) == \</span></pre>
<pre class='cython line score-0'>&#xA0;376: <span class="sd">    {&#39;ctermE&#39;: 1, &#39;E&#39;: 1, &#39;D&#39;: 1, &#39;P&#39;: 1, &#39;T&#39;: 1, &#39;ntermP&#39;: 1}</span></pre>
<pre class='cython line score-0'>&#xA0;377: <span class="sd">    True</span></pre>
<pre class='cython line score-0'>&#xA0;378: <span class="sd">    &gt;&gt;&gt; amino_acid_composition(&#39;PEPpTIDE&#39;, labels=std_labels+[&#39;pT&#39;]) == \</span></pre>
<pre class='cython line score-0'>&#xA0;379: <span class="sd">    {&#39;I&#39;: 1, &#39;P&#39;: 2, &#39;E&#39;: 2, &#39;D&#39;: 1, &#39;pT&#39;: 1}</span></pre>
<pre class='cython line score-0'>&#xA0;380: <span class="sd">    True</span></pre>
<pre class='cython line score-0'>&#xA0;381: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;382:     <span class="n">cdef</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;383:         <span class="nb">list</span> <span class="n">parsed_sequence</span></pre>
<pre class='cython line score-0'>&#xA0;384:         <span class="nb">int</span> <span class="n">nterm_aa_position</span><span class="p">,</span> <span class="n">cterm_aa_position</span><span class="p">,</span> <span class="n">aa_count</span></pre>
<pre class='cython line score-0'>&#xA0;385:         <span class="nb">dict</span> <span class="n">aa_dict</span></pre>
<pre class='cython line score-0'>&#xA0;386:         <span class="nb">tuple</span> <span class="n">aa</span></pre>
<pre class='cython line score-0'>&#xA0;387:         <span class="nb">list</span> <span class="n">_labels</span></pre>
<pre class='cython line score-0'>&#xA0;388:         <span class="nb">object</span> <span class="n">temp</span></pre>
<pre class='cython line score-0'>&#xA0;389:         <span class="n">PyObject</span><span class="o">*</span> <span class="n">pvalue</span></pre>
<pre class='cython line score-0'>&#xA0;390:         <span class="n">Py_ssize_t</span> <span class="n">i</span></pre>
<pre class='cython line score-0'>&#xA0;391: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+392:     <span class="n">_labels</span> <span class="o">=</span> <span class="n">interpolate_labels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_f_9pyteomics_7cparser_interpolate_labels(__pyx_v_labels);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v__labels = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;393: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+394:     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span></pre>
<pre class='cython code score-5'>  __pyx_t_2 = <span class='py_c_api'>PyString_Check</span>(__pyx_v_sequence); 
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+395:         <span class="n">parsed_sequence</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(&lt;</span><span class="kt">str</span><span class="p">&gt;</span><span class="n">sequence</span><span class="p">,</span> <span class="n">show_unmodified_termini</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span></pre>
<pre class='cython code score-0'>    __pyx_t_4.__pyx_n = 4;
    __pyx_t_4.show_unmodified_termini = __pyx_v_show_unmodified_termini;
    __pyx_t_4.split = 0;
    __pyx_t_4.allow_unknown_modifications = __pyx_v_allow_unknown_modifications;
    __pyx_t_4.labels = __pyx_v__labels;
    __pyx_t_1 = __pyx_f_9pyteomics_7cparser_parse(((PyObject*)__pyx_v_sequence), 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 395; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_v_parsed_sequence = ((PyObject*)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L3;
  }
</pre><pre class='cython line score-0'>&#xA0;396:                                 <span class="n">allow_unknown_modifications</span><span class="o">=</span><span class="n">allow_unknown_modifications</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;397:                                 <span class="n">labels</span><span class="o">=</span><span class="n">_labels</span><span class="p">)</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+398:     <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_sequence); 
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-12' onclick='toggleDiv(this)'>+399:         <span class="k">if</span> <span class="n">sequence</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(&lt;</span><span class="kt">object</span><span class="p">&gt;</span><span class="n">PyList_GetItem</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="mf">0</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">):</span></pre>
<pre class='cython code score-12'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_sequence);<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (__pyx_t_3) {
    } else {
      __pyx_t_2 = __pyx_t_3;
      goto __pyx_L5_bool_binop_done;
    }
    __pyx_t_5 = <span class='py_c_api'>PyList_GetItem</span>(__pyx_v_sequence, 0);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_3 = <span class='py_c_api'>PyTuple_Check</span>(((PyObject *)__pyx_t_5)); 
    __pyx_t_6 = (__pyx_t_3 != 0);
    __pyx_t_2 = __pyx_t_6;
    __pyx_L5_bool_binop_done:;
    if (__pyx_t_2) {
</pre><pre class='cython line score-37' onclick='toggleDiv(this)'>+400:             <span class="n">parsed_sequence</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">tostring</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span></pre>
<pre class='cython code score-37'>      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_tostring);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_8 = NULL;
      __pyx_t_9 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
          __pyx_t_9 = 1;
        }
      }
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (__pyx_t_8) {
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); __pyx_t_8 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sequence);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_9, __pyx_v_sequence);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sequence);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_9, Py_True);
      <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
/* … */
      __pyx_t_4.__pyx_n = 4;
      __pyx_t_4.show_unmodified_termini = __pyx_v_show_unmodified_termini;
      __pyx_t_4.split = 0;
      __pyx_t_4.allow_unknown_modifications = __pyx_v_allow_unknown_modifications;
      __pyx_t_4.labels = __pyx_v__labels;
      __pyx_t_7 = __pyx_f_9pyteomics_7cparser_parse(((PyObject*)__pyx_t_1), 0, &amp;__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_parsed_sequence = ((PyObject*)__pyx_t_7);
      __pyx_t_7 = 0;
      goto __pyx_L4;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;401:                 <span class="n">show_unmodified_termini</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;402:                 <span class="n">split</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;403:                 <span class="n">allow_unknown_modifications</span><span class="o">=</span><span class="n">allow_unknown_modifications</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;404:                 <span class="n">labels</span><span class="o">=</span><span class="n">_labels</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;405:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-11' onclick='toggleDiv(this)'>+406:             <span class="n">parsed_sequence</span> <span class="o">=</span> <span class="n">sequence</span></pre>
<pre class='cython code score-11'>      if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_sequence))||((__pyx_v_sequence) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_v_sequence)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 406; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_7 = __pyx_v_sequence;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      __pyx_v_parsed_sequence = ((PyObject*)__pyx_t_7);
      __pyx_t_7 = 0;
    }
    __pyx_L4:;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;407:     <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+408:         <span class="k">raise</span> <span class="n">PyteomicsError</span><span class="p">(</span><span class="s">&#39;Unsupported type of a sequence.&#39;</span></pre>
<pre class='cython code score-2'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_PyteomicsError);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+409:                 <span class="s">&#39;Must be str or list, not </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">sequence</span><span class="p">))</span></pre>
<pre class='cython code score-29'>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Unsupported_type_of_a_sequence_M, ((PyObject *)Py_TYPE(__pyx_v_sequence)));<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 409; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_8 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_8) {
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    } else {
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_8); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); __pyx_t_8 = NULL;
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+1, __pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      __pyx_t_10 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 408; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;410: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+411:     <span class="n">aa_dict</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-5'>  __pyx_t_7 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 411; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_v_aa_dict = ((PyObject*)__pyx_t_7);
  __pyx_t_7 = 0;
</pre><pre class='cython line score-0'>&#xA0;412:     <span class="c"># Process terminal amino acids.</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+413:     <span class="k">if</span> <span class="n">term_aa</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = (__pyx_v_term_aa != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-15' onclick='toggleDiv(this)'>+414:         <span class="k">if</span> <span class="n">is_term_mod</span><span class="p">(&lt;</span><span class="kt">object</span><span class="p">&gt;</span><span class="n">PyList_GetItem</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">,</span> <span class="mf">0</span><span class="p">)):</span></pre>
<pre class='cython code score-15'>    __pyx_t_5 = <span class='py_c_api'>PyList_GetItem</span>(__pyx_v_parsed_sequence, 0);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(((PyObject *)__pyx_t_5)))||((((PyObject *)__pyx_t_5)) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(((PyObject *)__pyx_t_5))-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = (__pyx_f_9pyteomics_7cparser_is_term_mod(((PyObject*)((PyObject *)__pyx_t_5)), 0) != 0);
    if (__pyx_t_2) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+415:             <span class="n">nterm_aa_position</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>      __pyx_v_nterm_aa_position = 1;
      goto __pyx_L8;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;416:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+417:             <span class="n">nterm_aa_position</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>      __pyx_v_nterm_aa_position = 0;
    }
    __pyx_L8:;
</pre><pre class='cython line score-18' onclick='toggleDiv(this)'>+418:         <span class="k">if</span> <span class="n">is_term_mod</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-18'>    if (unlikely(__pyx_v_parsed_sequence == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_parsed_sequence, -1, long, 1, __Pyx_PyInt_From_long, 1, 1, 1);<span class='error_goto'> if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_t_7))||((__pyx_t_7) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(__pyx_t_7)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 418; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = (__pyx_f_9pyteomics_7cparser_is_term_mod(((PyObject*)__pyx_t_7), 0) != 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (__pyx_t_2) {
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+419:             <span class="n">cterm_aa_position</span> <span class="o">=</span> <span class="n">PyList_Size</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">)</span> <span class="o">-</span> <span class="mf">2</span></pre>
<pre class='cython code score-5'>      __pyx_t_9 = <span class='py_c_api'>PyList_Size</span>(__pyx_v_parsed_sequence);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_v_cterm_aa_position = (__pyx_t_9 - 2);
      goto __pyx_L9;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;420:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+421:             <span class="n">cterm_aa_position</span> <span class="o">=</span> <span class="n">PyList_Size</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-5'>      __pyx_t_9 = <span class='py_c_api'>PyList_Size</span>(__pyx_v_parsed_sequence);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_v_cterm_aa_position = (__pyx_t_9 - 1);
    }
    __pyx_L9:;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+422:         <span class="k">if</span> <span class="n">PyList_Size</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5'>    __pyx_t_9 = <span class='py_c_api'>PyList_Size</span>(__pyx_v_parsed_sequence);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = ((__pyx_t_9 &gt; 1) != 0);
    if (__pyx_t_2) {
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+423:             <span class="n">temp</span> <span class="o">=</span> <span class="n">PyInt_FromLong</span><span class="p">(</span><span class="n">cterm_aa_position</span><span class="p">)</span></pre>
<pre class='cython code score-5'>      __pyx_t_7 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_cterm_aa_position);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_v_temp = __pyx_t_7;
      __pyx_t_7 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+424:             <span class="n">temp</span> <span class="o">=</span> <span class="n">PyObject_CallMethodObjArgs</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">,</span> <span class="s">&quot;pop&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">PyObject</span><span class="o">*&gt;</span><span class="n">temp</span><span class="p">,</span> <span class="bp">NULL</span><span class="p">)</span></pre>
<pre class='cython code score-6'>      __pyx_t_7 = <span class='py_c_api'>PyObject_CallMethodObjArgs</span>(__pyx_v_parsed_sequence, __pyx_n_s_pop, ((PyObject *)__pyx_v_temp), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_temp, __pyx_t_7);
      __pyx_t_7 = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+425:             <span class="n">PyDict_SetItem</span><span class="p">(</span><span class="n">aa_dict</span><span class="p">,</span> <span class="s">&#39;cterm&#39;</span> <span class="o">+</span> <span class="n">temp</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-11'>      __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_n_s_cterm, __pyx_v_temp);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_12 = <span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_aa_dict, __pyx_t_7, __pyx_int_1);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L10;
    }
    __pyx_L10:;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+426:         <span class="n">temp</span> <span class="o">=</span> <span class="n">PyInt_FromLong</span><span class="p">(</span><span class="n">nterm_aa_position</span><span class="p">)</span></pre>
<pre class='cython code score-6'>    __pyx_t_7 = <span class='py_c_api'>PyInt_FromLong</span>(__pyx_v_nterm_aa_position);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_temp, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+427:         <span class="n">temp</span> <span class="o">=</span> <span class="n">PyObject_CallMethodObjArgs</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">,</span> <span class="s">&quot;pop&quot;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">PyObject</span><span class="o">*&gt;</span><span class="n">temp</span><span class="p">,</span> <span class="bp">NULL</span><span class="p">)</span></pre>
<pre class='cython code score-6'>    __pyx_t_7 = <span class='py_c_api'>PyObject_CallMethodObjArgs</span>(__pyx_v_parsed_sequence, __pyx_n_s_pop, ((PyObject *)__pyx_v_temp), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_temp, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+428:         <span class="n">PyDict_SetItem</span><span class="p">(</span><span class="n">aa_dict</span><span class="p">,</span> <span class="s">&#39;nterm&#39;</span> <span class="o">+</span> <span class="n">temp</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-11'>    __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_n_s_nterm, __pyx_v_temp);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_12 = <span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_aa_dict, __pyx_t_7, __pyx_int_1);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    goto __pyx_L7;
  }
  __pyx_L7:;
</pre><pre class='cython line score-0'>&#xA0;429:     <span class="c"># Process core amino acids.</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+430:     <span class="n">i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_i = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+431:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">PyList_Size</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">)):</span></pre>
<pre class='cython code score-5'>  __pyx_t_9 = <span class='py_c_api'>PyList_Size</span>(__pyx_v_parsed_sequence);<span class='error_goto'> if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_9; __pyx_t_13+=1) {
    __pyx_v_i = __pyx_t_13;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+432:         <span class="n">aa</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">tuple</span><span class="p">&gt;</span><span class="n">PyList_GET_ITEM</span><span class="p">(</span><span class="n">parsed_sequence</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-3'>    __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_parsed_sequence, __pyx_v_i);
    __pyx_t_7 = ((PyObject *)__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_aa, ((PyObject*)__pyx_t_7));
    __pyx_t_7 = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+433:         <span class="n">pvalue</span> <span class="o">=</span> <span class="n">PyDict_GetItem</span><span class="p">(</span><span class="n">aa_dict</span><span class="p">,</span> <span class="n">aa</span><span class="p">)</span></pre>
<pre class='cython code score-5'>    __pyx_v_pvalue = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_v_aa_dict, __pyx_v_aa);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+434:         <span class="k">if</span> <span class="n">pvalue</span> <span class="o">==</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = ((__pyx_v_pvalue == NULL) != 0);
    if (__pyx_t_2) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+435:             <span class="n">aa_count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>      __pyx_v_aa_count = 0;
      goto __pyx_L13;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;436:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+437:             <span class="n">aa_count</span> <span class="o">=</span> <span class="n">PyInt_AsLong</span><span class="p">(&lt;</span><span class="kt">object</span><span class="p">&gt;</span><span class="n">pvalue</span><span class="p">)</span></pre>
<pre class='cython code score-5'>      __pyx_t_14 = <span class='py_c_api'>PyInt_AsLong</span>(((PyObject *)__pyx_v_pvalue));<span class='error_goto'> if (unlikely(__pyx_t_14 == -1 &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_v_aa_count = __pyx_t_14;
    }
    __pyx_L13:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+438:         <span class="n">aa_count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_aa_count = (__pyx_v_aa_count + 1);
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+439:         <span class="n">PyDict_SetItem</span><span class="p">(</span><span class="n">aa_dict</span><span class="p">,</span> <span class="n">aa</span><span class="p">,</span> <span class="n">aa_count</span><span class="p">)</span></pre>
<pre class='cython code score-8'>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_aa_count);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_12 = <span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_aa_dict, __pyx_v_aa, __pyx_t_7);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
</pre><pre class='cython line score-0'>&#xA0;440: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+441:     <span class="k">return</span> <span class="n">aa_dict</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_aa_dict);
  __pyx_r = __pyx_v_aa_dict;
  goto __pyx_L0;
</pre></div></body></html>
